[{"filePath":"C:\\Users\\hp\\OneDrive\\Documents\\Portfolilo\\TechSpark\\src\\components\\Admin\\OrganizerDashboard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[104,111],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    Calendar,\r\n    LogOut,\r\n    Plus,\r\n    X,\r\n    CheckCircle,\r\n    LayoutDashboard,\r\n    TrendingUp,\r\n    Users,\r\n    Clock,\r\n    MapPin,\r\n    Download,\r\n    FileText,\r\n    Shield,\r\n    UserMinus,\r\n    ChevronRight,\r\n    ChevronLeft,\r\n    ChevronUp,\r\n    ChevronDown,\r\n    Upload,\r\n    Globe,\r\n    Building2,\r\n    Info,\r\n    Settings,\r\n    Eye,\r\n    Save,\r\n    Send,\r\n    Briefcase,\r\n    UserCog,\r\n    ShieldCheck,\r\n    ArrowRight,\r\n    ClipboardList,\r\n    ArrowUpRight,\r\n    Search,\r\n    Briefcase as BriefcaseIcon,\r\n    QrCode,\r\n    Activity,\r\n    RotateCcw,\r\n    Zap,\r\n    Menu\r\n} from 'lucide-react';\r\nimport { collection, getDocs, query, orderBy, addDoc, serverTimestamp, deleteDoc, doc, where, updateDoc, increment, onSnapshot } from 'firebase/firestore';\r\nimport { db } from '../../firebase';\r\nimport { Scanner } from '@yudiel/react-qr-scanner';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport ritLogo from '../../assets/rit-logo.png';\r\nimport techsparkLogo from '../../assets/techspark-logo.png';\r\n\r\nconst OrganizerDashboard = () => {\r\n    const [organizer, setOrganizer] = useState(null);\r\n    const [events, setEvents] = useState([]);\r\n    const [stats, setStats] = useState({\r\n        total: 0,\r\n        pending: 0,\r\n        live: 0,\r\n        rejected: 0,\r\n        completed: 0,\r\n        draft: 0,\r\n        totalRegs: 0\r\n    });\r\n    const [, setLoadingData] = useState(true);\r\n    const [currentView, setCurrentView] = useState('dashboard');\r\n    const [activeStep, setActiveStep] = useState(1);\r\n    const [selectedEvent, setSelectedEvent] = useState(null);\r\n    const [registrations, setRegistrations] = useState([]);\r\n    const [allRegs, setAllRegs] = useState([]); // All regs for all events of organizer\r\n    const [loadingRegs, setLoadingRegs] = useState(false);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [editingEventId, setEditingEventId] = useState(null); // null = create new, otherwise = editing\r\n    const [showFeedbackModal, setShowFeedbackModal] = useState(false);\r\n    const [selectedEventFeedback, setSelectedEventFeedback] = useState([]);\r\n    const [loadingFeedback, setLoadingFeedback] = useState(false);\r\n    const [submissions, setSubmissions] = useState([]);\r\n    const [loadingSubmissions, setLoadingSubmissions] = useState(false);\r\n\r\n    // Registration Search & Filter State\r\n    const [regSearchQuery, setRegSearchQuery] = useState('');\r\n    const [regDeptFilter, setRegDeptFilter] = useState('all');\r\n    const [regYearFilter, setRegYearFilter] = useState('all');\r\n    const [showFlaggedOnly, setShowFlaggedOnly] = useState(false);\r\n    const [isScannerOpen, setIsScannerOpen] = useState(false);\r\n    const [isScanning, setIsScanning] = useState(false);\r\n    const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\r\n\r\n    // Custom Export System\r\n    const [isExportModalOpen, setIsExportModalOpen] = useState(false);\r\n    const [exportType, setExportType] = useState('REGISTRATION'); // REGISTRATION or ATTENDANCE\r\n    const [selectedFields, setSelectedFields] = useState([\r\n        'name', 'roll', 'dept', 'year', 'section', 'phone', 'squad', 'role', 'problem', 'date', 'status'\r\n    ]);\r\n\r\n    const availableFields = [\r\n        { id: 'name', label: 'FULL NAME', category: 'Identity' },\r\n        { id: 'roll', label: 'ROLL NO', category: 'Identity' },\r\n        { id: 'dept', label: 'DEPARTMENT', category: 'Academic' },\r\n        { id: 'year', label: 'YEAR', category: 'Academic' },\r\n        { id: 'section', label: 'SECTION', category: 'Academic' },\r\n        { id: 'phone', label: 'MOBILE NO', category: 'Contact' },\r\n        { id: 'squad', label: 'SQUAD/TEAM', category: 'Team' },\r\n        { id: 'role', label: 'SQUAD ROLE', category: 'Team' },\r\n        { id: 'problem', label: 'PROBLEM STATEMENT', category: 'Strategic' },\r\n        { id: 'date', label: 'REG DATE', category: 'Timeline' },\r\n        { id: 'status', label: 'ATTENDANCE', category: 'Admin' },\r\n    ];\r\n\r\n    const navigate = useNavigate();\r\n\r\n    // Multi-step Form Data\r\n    const [formData, setFormData] = useState({\r\n        title: '',\r\n        type: 'Workshop',\r\n        shortDescription: '',\r\n        detailedDescription: '',\r\n        posterUrl: '',\r\n        startDate: '',\r\n        startTime: '',\r\n        endDate: '',\r\n        endTime: '',\r\n        venueType: 'Offline',\r\n        venueName: '',\r\n        googleMapLink: '',\r\n        audienceType: 'Whole College',\r\n        departments: [],\r\n        years: [],\r\n        sections: [],\r\n        registrationRequired: true,\r\n        regStartDateTime: '',\r\n        regEndDateTime: '',\r\n        maxParticipants: '',\r\n        waitingList: false,\r\n        isTeamEvent: false,\r\n        minTeamSize: 1,\r\n        maxTeamSize: 4,\r\n        problemStatements: [],\r\n        allowOpenStatement: false,\r\n        // Quiz specific fields\r\n        quizFormUrl: '',\r\n        quizEntryName: '',\r\n        quizEntryRoll: '',\r\n        quizEntryDept: '',\r\n        quizEntryYear: '',\r\n        quizEntrySection: '',\r\n        quizEntryMobile: '',\r\n        coordinatorName: '',\r\n        coordinatorPhone: '',\r\n        coordinatorEmail: '',\r\n        displayCoordinator: true,\r\n        terms: '',\r\n        acceptedTerms: false,\r\n        internalNotes: ''\r\n    });\r\n\r\n    const [globalDemographics, setGlobalDemographics] = useState({\r\n        departments: [],\r\n        years: [],\r\n        sections: []\r\n    });\r\n\r\n    const [profileData, setProfileData] = useState({\r\n        fullName: '',\r\n        email: '',\r\n        phone: '',\r\n        department: ''\r\n    });\r\n\r\n    const fetchInitialData = (username) => {\r\n        if (!username) {\r\n            console.error(\"Operational Error: Missing Lead Identity\");\r\n            setLoadingData(false);\r\n            return () => { }; // Return an empty cleanup function\r\n        }\r\n\r\n        setLoadingData(true);\r\n        console.log(\"Initializing Dashboard for Lead:\", username);\r\n\r\n        // 1. Listen to Organizer Events (Real-time)\r\n        const eventsQuery = query(\r\n            collection(db, 'events'),\r\n            where('createdBy', '==', username)\r\n        );\r\n\r\n        let unsubscribeRegs = null;\r\n        let unsubscribeUsers = null;\r\n\r\n        const unsubscribeEvents = onSnapshot(eventsQuery, (snapshot) => {\r\n            const eventList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))\r\n                .sort((a, b) => {\r\n                    const timeA = a.createdAt?.seconds || 0;\r\n                    const timeB = b.createdAt?.seconds || 0;\r\n                    return timeB - timeA;\r\n                });\r\n\r\n            setEvents(eventList);\r\n            setLoadingData(false);\r\n\r\n            // 2. Clear old reg listener if any\r\n            if (unsubscribeRegs) unsubscribeRegs();\r\n\r\n            // 3. Setup Registration Listener for these events\r\n            const eventIds = eventList.map(e => e.id);\r\n            const allRegsQuery = query(collection(db, 'registrations'));\r\n\r\n            unsubscribeRegs = onSnapshot(allRegsQuery, (regSnapshot) => {\r\n                const allSystemRegs = regSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n                const filteredRegs = allSystemRegs.filter(reg => eventIds.includes(reg.eventId));\r\n                setAllRegs(filteredRegs);\r\n                console.log(`Synced ${filteredRegs.length} total registrations across ${eventList.length} missions.`);\r\n            });\r\n\r\n            // 4. Listen to ALL Students (Users) for dynamic Eligibility Scope\r\n            const usersQuery = query(collection(db, 'users'));\r\n            unsubscribeUsers = onSnapshot(usersQuery, (userSnapshot) => {\r\n                const allUsers = userSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n\r\n                const depts = new Set();\r\n                const yearsNumeric = new Set();\r\n                const sections = new Set();\r\n\r\n                // Year Mapper for professional display\r\n                const yearMap = { '1': 'I', '2': 'II', '3': 'III', '4': 'IV', 'Alumni': 'Alumni' };\r\n\r\n\r\n                allUsers.forEach(u => {\r\n                    if (u.department) depts.add(u.department.toUpperCase());\r\n                    if (u.yearOfStudy) yearsNumeric.add(u.yearOfStudy.toString());\r\n                    if (u.section) sections.add(u.section.toUpperCase());\r\n                });\r\n\r\n                // Helper to safely sort and map years\r\n                const sortedYears = Array.from(yearsNumeric)\r\n                    .sort((a, b) => {\r\n                        if (a === 'Alumni') return 1;\r\n                        if (b === 'Alumni') return -1;\r\n                        return parseInt(a) - parseInt(b);\r\n                    })\r\n                    .map(y => yearMap[y] || y);\r\n\r\n                setGlobalDemographics({\r\n                    departments: Array.from(depts).sort(),\r\n                    years: sortedYears,\r\n                    sections: Array.from(sections).sort()\r\n                });\r\n\r\n                console.log(`Synced Demographics from ${allUsers.length} registered students.`);\r\n            });\r\n        }, (error) => {\r\n            console.error(\"Operational Data Sync Error:\", error);\r\n            setLoadingData(false);\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeEvents();\r\n            if (unsubscribeRegs) unsubscribeRegs();\r\n            if (unsubscribeUsers) unsubscribeUsers();\r\n        };\r\n    };\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem('organizerToken');\r\n        if (!token) {\r\n            navigate('/organizer/login');\r\n            return;\r\n        }\r\n        try {\r\n            const org = JSON.parse(token);\r\n            setOrganizer(org);\r\n            setProfileData({\r\n                fullName: org.fullName || '',\r\n                email: org.email || '',\r\n                phone: org.phone || '',\r\n                department: org.department || ''\r\n            });\r\n\r\n            // Initialize Real-time Data Sync\r\n            const unsubscribe = fetchInitialData(org.username);\r\n\r\n            return () => {\r\n                if (unsubscribe && typeof unsubscribe === 'function') {\r\n                    unsubscribe();\r\n                }\r\n            };\r\n        } catch (e) {\r\n            console.error(\"Authentication Token Corrupted:\", e);\r\n            localStorage.removeItem('organizerToken');\r\n            navigate('/organizer/login');\r\n        }\r\n    }, [navigate]);\r\n\r\n    // Real-time listener for DETAILED registrations when an event is selected\r\n    useEffect(() => {\r\n        if (!selectedEvent?.id) {\r\n            setRegistrations([]);\r\n            return;\r\n        }\r\n\r\n        console.log(\"Establishing Tactical Link for:\", selectedEvent.title);\r\n        setLoadingRegs(true);\r\n\r\n        const q = query(\r\n            collection(db, 'registrations'),\r\n            where('eventId', '==', selectedEvent.id)\r\n        );\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            const regList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n            setRegistrations(regList);\r\n            setLoadingRegs(false);\r\n            console.log(`Live Intelligence Sync: ${regList.length} agents detected.`);\r\n        }, (error) => {\r\n            console.error(\"Link Failure in Detail sync:\", error);\r\n            setLoadingRegs(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [selectedEvent?.id, selectedEvent?.title]);\r\n\r\n    // Real-time listener for Quiz Submissions\r\n    useEffect(() => {\r\n        if (currentView !== 'submissions' || !organizer?.username) return;\r\n\r\n        setLoadingSubmissions(true);\r\n        console.log(\"Establishing Live Score Link...\");\r\n\r\n        const q = query(\r\n            collection(db, 'quizSubmissions'),\r\n            orderBy('timestamp', 'desc')\r\n        );\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            const subsList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n            // Filter submissions relevant to the organizer's events\r\n            const organizerEventIds = events.map(e => e.id);\r\n            const filteredSubs = subsList.filter(s => organizerEventIds.includes(s.eventId));\r\n            setSubmissions(filteredSubs);\r\n            setLoadingSubmissions(false);\r\n            console.log(`Live Intelligence Sync: ${filteredSubs.length} submissions detected.`);\r\n        }, (error) => {\r\n            console.error(\"Link Failure in Submissions sync:\", error);\r\n            setLoadingSubmissions(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [currentView, organizer?.username, events]);\r\n\r\n    // Reactive Stats Calculation\r\n    useEffect(() => {\r\n        setStats({\r\n            total: events.length,\r\n            pending: events.filter(e => e.status === 'PENDING').length,\r\n            live: events.filter(e => e.status === 'LIVE').length,\r\n            rejected: events.filter(e => e.status === 'REJECTED').length,\r\n            draft: events.filter(e => e.status === 'DRAFT').length,\r\n            completed: events.filter(e => e.status === 'COMPLETED').length,\r\n            totalRegs: allRegs.length\r\n        });\r\n\r\n        // Sync selectedEvent with the updated list to reflect real-time attendee counts etc.\r\n        if (selectedEvent) {\r\n            const updated = events.find(e => e.id === selectedEvent.id);\r\n            if (updated && JSON.stringify(updated) !== JSON.stringify(selectedEvent)) {\r\n                setSelectedEvent(updated);\r\n            }\r\n        }\r\n    }, [events, allRegs, selectedEvent]);\r\n\r\n    const fetchEvents = async () => {\r\n        if (organizer) fetchInitialData(organizer.username);\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem('organizerToken');\r\n        navigate('/organizer/login');\r\n    };\r\n\r\n    const handleCreateEvent = async (status = 'PENDING') => {\r\n        if (status === 'PENDING' && !formData.acceptedTerms) {\r\n            alert(\"Please accept the terms and conditions.\");\r\n            return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const eventData = {\r\n                ...formData,\r\n                status: status,\r\n                remarks: editingEventId ? formData.remarks : '',\r\n                updatedAt: serverTimestamp(),\r\n                createdBy: organizer.username,\r\n                // Map legacy fields for compatibility\r\n                date: `${formData.startDate} | ${formData.startTime}`,\r\n                venue: formData.venueName,\r\n                description: formData.shortDescription\r\n            };\r\n\r\n            if (editingEventId) {\r\n                // Update existing event\r\n                await updateDoc(doc(db, 'events', editingEventId), eventData);\r\n                alert(status === 'DRAFT' ? \"Event updated and saved as draft. ≡ƒô¥\" : \"Event updated and resubmitted for approval. ≡ƒÜÇ\");\r\n            } else {\r\n                // Create new event\r\n                eventData.attendeesCount = 0;\r\n                eventData.createdAt = serverTimestamp();\r\n                await addDoc(collection(db, 'events'), eventData);\r\n                alert(status === 'DRAFT' ? \"Event saved as draft. ≡ƒô¥\" : \"Event submitted for Super Admin approval. ≡ƒÜÇ\");\r\n            }\r\n\r\n            // Success reset\r\n            resetFormAndGoBack();\r\n        } catch (error) {\r\n            console.error(\"Error saving event:\", error);\r\n            alert(\"Failed to save event. Try again.\");\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const resetFormAndGoBack = () => {\r\n        setCurrentView('my_events');\r\n        setActiveStep(1);\r\n        setEditingEventId(null);\r\n        setFormData({\r\n            title: '', type: 'Workshop', shortDescription: '', detailedDescription: '', posterUrl: '',\r\n            startDate: '', startTime: '', endDate: '', endTime: '', venueType: 'Offline', venueName: '', googleMapLink: '',\r\n            audienceType: 'Whole College', departments: [], years: [], sections: [],\r\n            registrationRequired: true, regStartDateTime: '', regEndDateTime: '', maxParticipants: '', waitingList: false,\r\n            isTeamEvent: false, minTeamSize: 1, maxTeamSize: 4, problemStatements: [], allowOpenStatement: false,\r\n            quizFormUrl: '', quizEntryName: '', quizEntryRoll: '', quizEntryDept: '',\r\n            quizEntryYear: '', quizEntrySection: '', quizEntryMobile: '',\r\n            coordinatorName: '', coordinatorPhone: '', coordinatorEmail: '', displayCoordinator: true,\r\n            terms: '', acceptedTerms: false, internalNotes: ''\r\n        });\r\n    };\r\n\r\n    const handleEditEvent = (event) => {\r\n        // Only allow editing DRAFT or REJECTED events\r\n        if (event.status !== 'DRAFT' && event.status !== 'REJECTED') {\r\n            alert(\"Only DRAFT or REJECTED events can be edited.\");\r\n            return;\r\n        }\r\n\r\n        // Populate form with existing event data\r\n        setFormData({\r\n            title: event.title || '',\r\n            type: event.type || 'Workshop',\r\n            shortDescription: event.shortDescription || event.description || '',\r\n            detailedDescription: event.detailedDescription || '',\r\n            posterUrl: event.posterUrl || '',\r\n            startDate: event.startDate || '',\r\n            startTime: event.startTime || '',\r\n            endDate: event.endDate || '',\r\n            endTime: event.endTime || '',\r\n            venueType: event.venueType || 'Offline',\r\n            venueName: event.venueName || event.venue || '',\r\n            googleMapLink: event.googleMapLink || '',\r\n            audienceType: event.audienceType || 'Whole College',\r\n            departments: event.departments || [],\r\n            years: event.years || [],\r\n            sections: event.sections || [],\r\n            registrationRequired: event.registrationRequired !== false,\r\n            regStartDateTime: event.regStartDateTime || '',\r\n            regEndDateTime: event.regEndDateTime || '',\r\n            maxParticipants: event.maxParticipants || '',\r\n            waitingList: event.waitingList || false,\r\n            isTeamEvent: event.isTeamEvent || false,\r\n            minTeamSize: event.minTeamSize || 1,\r\n            maxTeamSize: event.maxTeamSize || 4,\r\n            coordinatorName: event.coordinatorName || '',\r\n            coordinatorPhone: event.coordinatorPhone || '',\r\n            coordinatorEmail: event.coordinatorEmail || '',\r\n            displayCoordinator: event.displayCoordinator !== false,\r\n            terms: event.terms || '',\r\n            acceptedTerms: false, // Reset for re-acceptance\r\n            internalNotes: event.internalNotes || '',\r\n            remarks: event.remarks || '',\r\n            // Quiz fields\r\n            quizFormUrl: event.quizFormUrl || '',\r\n            quizEntryName: event.quizEntryName || '',\r\n            quizEntryRoll: event.quizEntryRoll || '',\r\n            quizEntryDept: event.quizEntryDept || '',\r\n            quizEntryYear: event.quizEntryYear || '',\r\n            quizEntrySection: event.quizEntrySection || '',\r\n            quizEntryMobile: event.quizEntryMobile || ''\r\n        });\r\n\r\n        setEditingEventId(event.id);\r\n        setActiveStep(1);\r\n        setCurrentView('create');\r\n    };\r\n\r\n\r\n    const handleScannerResult = async (result) => {\r\n        if (!result || isScanning) return;\r\n        setIsScanning(true);\r\n\r\n        try {\r\n            let scannedValue = result[0]?.rawValue || result;\r\n            console.log('Raw Scan Output:', scannedValue);\r\n\r\n            // 1. Check if it's already a clean roll number\r\n            if (/^\\d{10,15}$/.test(scannedValue)) {\r\n                setRegSearchQuery(scannedValue);\r\n                setIsScannerOpen(false);\r\n                return;\r\n            }\r\n\r\n            // 2. Check if it's a URL (Extract from RIT Verification Page if applicable)\r\n            if (scannedValue.startsWith('http')) {\r\n                const url = scannedValue;\r\n                let response;\r\n                try {\r\n                    response = await fetch(url, { method: 'GET', mode: 'cors', headers: { 'Accept': 'text/html' } });\r\n                } catch {\r\n                    const proxyUrl = 'https://api.allorigins.win/raw?url=';\r\n                    response = await fetch(proxyUrl + encodeURIComponent(url));\r\n                }\r\n\r\n                if (response.ok) {\r\n                    const html = await response.text();\r\n                    const patterns = [\r\n                        /Register Number[:\\s]*(\\d+)/i,\r\n                        /Registration Number[:\\s]*(\\d+)/i,\r\n                        /Roll Number[:\\s]*(\\d+)/i,\r\n                        /Roll No[:\\s.]*(\\d+)/i,\r\n                        /Reg\\.?\\s*No\\.?[:\\s]*(\\d+)/i,\r\n                        /<td[^>]*>(\\d{10,15})<\\/td>/i,\r\n                    ];\r\n\r\n                    let rollNumber = null;\r\n                    for (const pattern of patterns) {\r\n                        const match = html.match(pattern);\r\n                        if (match && match[1]) {\r\n                            rollNumber = match[1];\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if (rollNumber) {\r\n                        setRegSearchQuery(rollNumber);\r\n                        setIsScannerOpen(false);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // If we reach here, we couldn't parse it\r\n            alert(\"No recognizable Register Number found in this QR code.\");\r\n        } catch (error) {\r\n            console.error('Scan Error:', error);\r\n            alert(\"Failed to read QR code. Please try manual entry.\");\r\n        } finally {\r\n            setIsScanning(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteEvent = async (id) => {\r\n        if (!window.confirm(\"Are you sure you want to delete this operation? This action is irreversible.\")) return;\r\n        try {\r\n            await deleteDoc(doc(db, 'events', id));\r\n            fetchEvents();\r\n        } catch (error) {\r\n            console.error(\"Delete error:\", error);\r\n        }\r\n    };\r\n\r\n    // Quick Action: Close Registration (keep event LIVE but stop new registrations)\r\n    const handleCloseRegistration = async (eventId) => {\r\n        if (!window.confirm(\"Close registrations for this event? New participants won't be able to register.\")) return;\r\n        try {\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                registrationOpen: false,\r\n                registrationClosedAt: serverTimestamp()\r\n            });\r\n            fetchEvents();\r\n            alert(\"Γ£à Registrations closed successfully!\");\r\n        } catch (error) {\r\n            console.error(\"Error closing registration:\", error);\r\n            alert(\"Failed to close registrations.\");\r\n        }\r\n    };\r\n\r\n    // Quick Action: Reopen Registration\r\n    const handleReopenRegistration = async (eventId) => {\r\n        if (!window.confirm(\"Reopen registrations for this event?\")) return;\r\n        try {\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                registrationOpen: true\r\n            });\r\n            fetchEvents();\r\n            alert(\"Γ£à Registrations reopened!\");\r\n        } catch (error) {\r\n            console.error(\"Error reopening registration:\", error);\r\n            alert(\"Failed to reopen registrations.\");\r\n        }\r\n    };\r\n\r\n    // Quick Action: Enable Quiz (Allow students to start the quiz)\r\n    const handleEnableQuiz = async (eventId) => {\r\n        if (!window.confirm(\"Enable quiz for this event? Students will be able to start the quiz.\")) return;\r\n        try {\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                quizEnabled: true,\r\n                quizEnabledAt: serverTimestamp()\r\n            });\r\n            fetchEvents();\r\n            alert(\"Γ£à Quiz ENABLED! Students can now start the quiz.\");\r\n        } catch (error) {\r\n            console.error(\"Error enabling quiz:\", error);\r\n            alert(\"Failed to enable quiz.\");\r\n        }\r\n    };\r\n\r\n    // Quick Action: Disable Quiz (Prevent students from starting the quiz)\r\n    const handleDisableQuiz = async (eventId) => {\r\n        if (!window.confirm(\"Disable quiz for this event? Students won't be able to start the quiz.\")) return;\r\n        try {\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                quizEnabled: false,\r\n                quizDisabledAt: serverTimestamp()\r\n            });\r\n            fetchEvents();\r\n            alert(\"≡ƒÜ½ Quiz DISABLED! Students cannot start the quiz now.\");\r\n        } catch (error) {\r\n            console.error(\"Error disabling quiz:\", error);\r\n            alert(\"Failed to disable quiz.\");\r\n        }\r\n    };\r\n\r\n    const handleViewFeedback = async (eventId) => {\r\n        setLoadingFeedback(true);\r\n        setShowFeedbackModal(true);\r\n        try {\r\n            const q = query(collection(db, 'feedback'), where('eventId', '==', eventId));\r\n            const snapshot = await getDocs(q);\r\n            const feedbackList = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))\r\n                .sort((a, b) => {\r\n                    const timeA = a.submittedAt?.seconds || 0;\r\n                    const timeB = b.submittedAt?.seconds || 0;\r\n                    return timeB - timeA;\r\n                });\r\n            setSelectedEventFeedback(feedbackList);\r\n        } catch (error) {\r\n            console.error(\"Error fetching feedback:\", error);\r\n        } finally {\r\n            setLoadingFeedback(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadFeedbackPDF = async () => {\r\n        if (!selectedEventFeedback.length) return;\r\n        const currentEvent = events.find(e => e.id === selectedEventFeedback[0].eventId);\r\n        if (!currentEvent) return;\r\n\r\n        try {\r\n            const doc = new jsPDF();\r\n            const loadImage = (url) => new Promise((resolve) => {\r\n                const img = new Image();\r\n                img.src = url;\r\n                img.onload = () => resolve(img);\r\n                img.onerror = () => resolve(null);\r\n            });\r\n\r\n            const [ritImg, tsImg] = await Promise.all([loadImage(ritLogo), loadImage(techsparkLogo)]);\r\n\r\n            const centerX = 107.5;\r\n            doc.setFillColor(15, 23, 42);\r\n            doc.rect(0, 0, 5, 297, 'F');\r\n            doc.setFillColor(255, 255, 255);\r\n            doc.rect(5, 0, 205, 60, 'F');\r\n\r\n            if (ritImg) doc.addImage(ritImg, 'PNG', 18, 12, 42, 36);\r\n            if (tsImg) doc.addImage(tsImg, 'PNG', 210 - 18 - 34, 12, 34, 34);\r\n\r\n            doc.setTextColor(15, 23, 42);\r\n            doc.setFont('helvetica', 'bold');\r\n            doc.setFontSize(24);\r\n            doc.text('TECHSPARK CLUB', centerX, 25, { align: 'center' });\r\n\r\n            doc.setFontSize(9);\r\n            doc.setTextColor(100, 116, 139);\r\n            doc.setFont('helvetica', 'normal');\r\n            doc.text('RAJALAKSHMI INSTITUTE OF TECHNOLOGY', centerX, 31, { align: 'center' });\r\n\r\n            doc.setTextColor(59, 130, 246);\r\n            doc.setFontSize(11);\r\n            doc.setFont('helvetica', 'bold');\r\n            doc.text('FEEDBACK INTELLIGENCE REPORT', centerX, 38, { align: 'center' });\r\n\r\n            doc.setFillColor(15, 23, 42);\r\n            doc.roundedRect(centerX - 55, 44, 110, 10, 2, 2, 'F');\r\n            doc.setTextColor(255, 255, 255);\r\n            doc.setFontSize(10);\r\n            doc.setFont('helvetica', 'bold');\r\n            doc.text(currentEvent.title.toUpperCase(), centerX, 50.5, { align: 'center' });\r\n\r\n            doc.setTextColor(15, 23, 42);\r\n            doc.setFontSize(9);\r\n            doc.text('PERFORMANCE DATA:', 20, 75);\r\n            const avgRating = (selectedEventFeedback.reduce((acc, curr) => acc + curr.rating, 0) / selectedEventFeedback.length).toFixed(1);\r\n            doc.setFont('helvetica', 'normal');\r\n            doc.setTextColor(71, 85, 105);\r\n            doc.text(`VOLUME: ${selectedEventFeedback.length} Responses`, 20, 83);\r\n            doc.text(`AVG RATING: ${avgRating} / 5.0`, 20, 88);\r\n\r\n            const tableData = selectedEventFeedback.map((item, index) => [\r\n                index + 1,\r\n                item.studentName.toUpperCase(),\r\n                item.studentRoll,\r\n                item.rating,\r\n                item.category.toUpperCase(),\r\n                item.comment || 'N/A'\r\n            ]);\r\n\r\n            autoTable(doc, {\r\n                startY: 100,\r\n                head: [['#', 'STUDENT NAME', 'ROLL NO', 'RATE', 'FOCUS AREA', 'COMMENT/DEBRIEF']],\r\n                body: tableData,\r\n                theme: 'grid',\r\n                headStyles: { fillColor: [15, 23, 42], textColor: [255, 255, 255], fontSize: 8, fontStyle: 'bold', halign: 'center' },\r\n                bodyStyles: { fontSize: 7, textColor: [30, 41, 59] },\r\n                columnStyles: {\r\n                    5: { cellWidth: 70 }\r\n                },\r\n                margin: { left: 15, right: 15 }\r\n            });\r\n\r\n            doc.save(`${currentEvent.title.replace(/\\s+/g, '_')}_Feedback_Report.pdf`);\r\n        } catch (error) {\r\n            console.error(\"PDF Error:\", error);\r\n            alert(\"Failed to generate PDF.\");\r\n        }\r\n    };\r\n\r\n    // Quick Action: Mark Event as Completed\r\n    const handleMarkComplete = async (eventId) => {\r\n        if (!window.confirm(\"Mark this event as completed? This indicates the event has concluded.\")) return;\r\n        try {\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                status: 'COMPLETED',\r\n                completedAt: serverTimestamp(),\r\n                registrationOpen: false\r\n            });\r\n            fetchEvents();\r\n            alert(\"Γ£à Event marked as completed!\");\r\n        } catch (error) {\r\n            console.error(\"Error marking complete:\", error);\r\n            alert(\"Failed to mark event as completed.\");\r\n        }\r\n    };\r\n\r\n    const handleViewDetails = (event) => {\r\n        setSelectedEvent(event);\r\n        // Reset filters when viewing new event\r\n        setRegSearchQuery('');\r\n        setRegDeptFilter('all');\r\n        setRegYearFilter('all');\r\n    };\r\n\r\n    // Delete a registration (remove participant from event)\r\n    const handleDeleteRegistration = async (regId, eventId) => {\r\n        if (!window.confirm(\"Remove this participant from the event? This action cannot be undone.\")) return;\r\n\r\n        try {\r\n            // Delete registration document\r\n            await deleteDoc(doc(db, 'registrations', regId));\r\n\r\n            // Decrement attendee count on the event\r\n            await updateDoc(doc(db, 'events', eventId), {\r\n                attendeesCount: increment(-1)\r\n            });\r\n\r\n            // Update local state\r\n            setRegistrations(prev => prev.filter(r => r.id !== regId));\r\n\r\n            // Also update selectedEvent if viewing details\r\n            if (selectedEvent && selectedEvent.id === eventId) {\r\n                setSelectedEvent(prev => ({\r\n                    ...prev,\r\n                    attendeesCount: Math.max(0, (prev.attendeesCount || 1) - 1)\r\n                }));\r\n            }\r\n\r\n            alert(\"Γ£à Participant removed successfully!\");\r\n        } catch (error) {\r\n            console.error(\"Error removing participant:\", error);\r\n            alert(\"Failed to remove participant.\");\r\n        }\r\n    };\r\n\r\n    // Undo Check-in (Keep registration but mark as not attended)\r\n    const handleUndoCheckIn = async (regId) => {\r\n        if (!window.confirm(\"Revert check-in for this participant? They will be marked as 'Registered' again.\")) return;\r\n\r\n        try {\r\n            await updateDoc(doc(db, 'registrations', regId), {\r\n                status: 'Registered',\r\n                isAttended: false,\r\n                checkedInAt: null\r\n            });\r\n\r\n            // Update local state\r\n            setRegistrations(prev => prev.map(r =>\r\n                r.id === regId ? { ...r, status: 'Registered', isAttended: false, checkedInAt: null } : r\r\n            ));\r\n\r\n            alert(\"Γ£à Check-in reverted successfully!\");\r\n        } catch (error) {\r\n            console.error(\"Error reverting check-in:\", error);\r\n            alert(\"Failed to revert check-in.\");\r\n        }\r\n    };\r\n\r\n    // Remove Flag from student (Give another chance)\r\n    const handleRemoveFlag = async (regId, studentName) => {\r\n        if (!window.confirm(`Remove FLAG from \"${studentName}\" and give them another chance?\\n\\nThis will clear all proctoring violations.`)) return;\r\n\r\n        try {\r\n            await updateDoc(doc(db, 'registrations', regId), {\r\n                status: 'Registered',\r\n                proctorViolations: 0,\r\n                terminatedAt: null,\r\n                terminationReason: null,\r\n                lastViolationType: null,\r\n                lastViolationAt: null,\r\n                flagRemoved: true,\r\n                flagRemovedAt: serverTimestamp(),\r\n                flagRemovedBy: profileData?.username || 'Organizer'\r\n            });\r\n\r\n            // Update local state\r\n            setRegistrations(prev => prev.map(r =>\r\n                r.id === regId ? {\r\n                    ...r,\r\n                    status: 'Registered',\r\n                    proctorViolations: 0,\r\n                    terminatedAt: null,\r\n                    terminationReason: null\r\n                } : r\r\n            ));\r\n\r\n            alert(`Γ£à FLAG removed from \"${studentName}\". They can now attempt the quiz again.`);\r\n        } catch (error) {\r\n            console.error(\"Error removing flag:\", error);\r\n            alert(\"Failed to remove flag.\");\r\n        }\r\n    };\r\n\r\n    // Get filtered registrations based on search and filters\r\n    const getFilteredRegistrations = () => {\r\n        return registrations.filter(reg => {\r\n            // Search filter\r\n            const searchMatch = regSearchQuery === '' ||\r\n                reg.studentName?.toLowerCase().includes(regSearchQuery.toLowerCase()) ||\r\n                reg.studentRoll?.toLowerCase().includes(regSearchQuery.toLowerCase());\r\n\r\n            // Department filter - handling potential case differences\r\n            const deptMatch = regDeptFilter === 'all' ||\r\n                reg.studentDept?.toString().toLowerCase() === regDeptFilter?.toString().toLowerCase();\r\n\r\n            // Year filter - handling string vs number comparison\r\n            const yearMatch = regYearFilter === 'all' ||\r\n                reg.studentYear?.toString() === regYearFilter?.toString();\r\n\r\n            // Flagged filter - show only students with proctoring violations\r\n            const flaggedMatch = !showFlaggedOnly ||\r\n                reg.status === 'FLAGGED' || reg.proctorViolations > 0;\r\n\r\n            return searchMatch && deptMatch && yearMatch && flaggedMatch;\r\n        });\r\n    };\r\n\r\n    // Get unique departments and years from registrations for filter options\r\n    const getUniqueValues = (key) => {\r\n        const values = new Set(registrations.map(r => r[key]?.toString()).filter(Boolean));\r\n        return Array.from(values).sort();\r\n    };\r\n\r\n    const handleDownloadSubReport = async (event, type) => {\r\n        if (!event) return;\r\n        console.log(`SUB-EXTRACTION: ${type} FOR MISSION: ${event.title}`);\r\n        const eventRegs = registrations.filter(r => r.eventId === event.id);\r\n\r\n        if (!eventRegs.length) {\r\n            alert(\"Strategic extraction aborted: No participant data found.\");\r\n            return;\r\n        }\r\n\r\n        let title = '';\r\n        let tableHead = [];\r\n        let tableData = [];\r\n        let filenameSuffix = '';\r\n        let summaryMetrics = [];\r\n\r\n        // Helper for breakdowns\r\n        const getBreakdown = (data) => {\r\n            const depts = {}, years = {}, sections = {};\r\n            data.forEach(r => {\r\n                depts[r.studentDept] = (depts[r.studentDept] || 0) + 1;\r\n                years[r.studentYear] = (years[r.studentYear] || 0) + 1;\r\n                sections[r.studentSection] = (sections[r.studentSection] || 0) + 1;\r\n            });\r\n            return { depts, years, sections };\r\n        };\r\n\r\n        if (type === 'REGISTRATION') {\r\n            title = 'EVENT REGISTRATION DIRECTORY';\r\n            const b = getBreakdown(eventRegs);\r\n            const squadCount = new Set(eventRegs.filter(r => r.isTeamRegistration).map(r => r.teamCode)).size;\r\n\r\n            // Deep Analysis\r\n            const topDept = Object.entries(b.depts).sort((a, b) => b[1] - a[1])[0];\r\n            const topYear = Object.entries(b.years).sort((a, b) => b[1] - a[1])[0];\r\n            const teamMembers = eventRegs.filter(r => r.isTeamRegistration).length;\r\n\r\n            summaryMetrics = [\r\n                ['TOTAL REGISTERED', eventRegs.length.toString()],\r\n                ['DIVERSITY INDEX', `${Object.keys(b.depts).length} DEPTS | ${Object.keys(b.years).length} YEARS`],\r\n                ['SQUAD INFRASTRUCTURE', `${squadCount} SQUADS | ${teamMembers} MEMBERS`],\r\n                ['INDIVIDUAL AGENTS', (eventRegs.length - teamMembers).toString()],\r\n                ['STRATEGIC HOTSPOT (DEPT)', `${topDept?.[0] || 'N/A'} (${topDept?.[1] || 0} REGS)`],\r\n                ['STRATEGIC HOTSPOT (YEAR)', `${topYear?.[0] || 'N/A'} YEAR (${topYear?.[1] || 0} REGS)`],\r\n                ['CAPACITY LOAD', `${((eventRegs.length / (event.maxParticipants || 1)) * 100).toFixed(1)}%`]\r\n            ];\r\n            filenameSuffix = 'Registration_Log';\r\n        } else if (type === 'ATTENDANCE') {\r\n            title = 'VERIFIED ATTENDANCE AUDIT';\r\n            const attended = eventRegs.filter(r => r.isAttended || r.status === 'Present');\r\n            const b = getBreakdown(attended);\r\n\r\n            // Deep Analysis\r\n            const attendanceRate = ((attended.length / eventRegs.length) * 100).toFixed(1);\r\n            const topAttendedDept = Object.entries(b.depts).sort((a, b) => b[1] - a[1])[0];\r\n            const topAttendedYear = Object.entries(b.years).sort((a, b) => b[1] - a[1])[0];\r\n            const teamAttendance = attended.filter(r => r.isTeamRegistration).length;\r\n            const individualAttendance = attended.length - teamAttendance;\r\n\r\n            // Malpractice count for Quiz events (3+ violations only)\r\n            const malpracticeCount = eventRegs.filter(r => r.status === 'FLAGGED' || r.proctorViolations >= 3).length;\r\n            const minorViolationsCount = eventRegs.filter(r => r.proctorViolations && r.proctorViolations > 0 && r.proctorViolations < 3).length;\r\n\r\n            // On-Spot Registration count\r\n            const onSpotCount = eventRegs.filter(r => r.isOnSpot).length;\r\n            const preRegisteredCount = eventRegs.length - onSpotCount;\r\n\r\n            summaryMetrics = [\r\n                ['CONFIRMED ATTENDEES', attended.length.toString()],\r\n                ['ATTENDANCE EFFICIENCY', `${attendanceRate}% OF REGISTRATIONS`],\r\n                ['ENGAGEMENT MIX', `${teamAttendance} TEAM | ${individualAttendance} INDIVIDUAL`],\r\n                ['≡ƒôï PRE-REGISTERED', preRegisteredCount.toString()],\r\n                ['≡ƒÜ╢ ON-SPOT REGISTRATIONS', onSpotCount > 0 ? `${onSpotCount} WALK-INS` : '0'],\r\n                ['ABSENTEE COUNT', (eventRegs.length - attended.length - malpracticeCount).toString()],\r\n                ...(event.type === 'Quiz' ? [\r\n                    ['≡ƒÜ⌐ MALPRACTICE (3+ FLAGS)', malpracticeCount > 0 ? `${malpracticeCount} TERMINATED` : '0 - ALL CLEAR'],\r\n                    ['ΓÜá∩╕Å MINOR VIOLATIONS (1-2)', minorViolationsCount > 0 ? `${minorViolationsCount} WARNED` : '0']\r\n                ] : []),\r\n                ['PEAK ENGAGEMENT (DEPT)', `${topAttendedDept?.[0] || 'N/A'} (${topAttendedDept?.[1] || 0} PRESENT)`],\r\n                ['PEAK ENGAGEMENT (YEAR)', `${topAttendedYear?.[0] || 'N/A'} YEAR (${topAttendedYear?.[1] || 0} PRESENT)`],\r\n                ['TACTICAL SPREAD', `${Object.keys(b.depts).length} DEPTS REPRESENTED`]\r\n            ];\r\n            filenameSuffix = 'Attendance_Checkin';\r\n        }\r\n\r\n        // Dynamic Header Generation\r\n        const activeHeaders = ['#'];\r\n        if (selectedFields.includes('name')) activeHeaders.push('NAME');\r\n        if (selectedFields.includes('roll')) activeHeaders.push('ROLL');\r\n        if (selectedFields.includes('dept')) activeHeaders.push('DEPT');\r\n        if (selectedFields.includes('year')) activeHeaders.push('YR');\r\n        if (selectedFields.includes('section')) activeHeaders.push('SEC');\r\n        if (selectedFields.includes('phone')) activeHeaders.push('PHONE');\r\n        if (selectedFields.includes('squad') && event.isTeamEvent) activeHeaders.push('SQUAD');\r\n        if (selectedFields.includes('role') && event.isTeamEvent) activeHeaders.push('ROLE');\r\n        if (selectedFields.includes('problem') && event.type === 'Hackathon') activeHeaders.push('PROBLEM');\r\n        if (selectedFields.includes('date')) activeHeaders.push('DATE');\r\n        if (selectedFields.includes('status')) activeHeaders.push('STATUS');\r\n\r\n        tableHead = [activeHeaders];\r\n\r\n        // Dynamic Data Generation\r\n        tableData = eventRegs.map((r, i) => {\r\n            const row = [i + 1];\r\n            if (selectedFields.includes('name')) row.push((r.studentName || 'N/A').toUpperCase());\r\n            if (selectedFields.includes('roll')) row.push(r.studentRoll || 'N/A');\r\n            if (selectedFields.includes('dept')) row.push(r.studentDept || 'N/A');\r\n            if (selectedFields.includes('year')) row.push(r.studentYear || 'N/A');\r\n            if (selectedFields.includes('section')) row.push(r.studentSection || 'N/A');\r\n            if (selectedFields.includes('phone')) row.push(r.studentPhone || 'N/A');\r\n            if (selectedFields.includes('squad') && event.isTeamEvent) row.push(r.isTeamRegistration ? (r.teamName || 'N/A') : 'INDIVIDUAL');\r\n            if (selectedFields.includes('role') && event.isTeamEvent) row.push(r.isTeamRegistration ? (r.teamRole || 'MEMBER') : 'N/A');\r\n            if (selectedFields.includes('problem') && event.type === 'Hackathon') row.push(r.problemStatement || 'N/A');\r\n            if (selectedFields.includes('date')) row.push(r.registeredAt?.toDate?.() ? new Date(r.registeredAt.toDate()).toLocaleDateString() : 'N/A');\r\n            if (selectedFields.includes('status')) {\r\n                // Check for MALPRACTICE (only for 3+ violations / FLAGGED status)\r\n                if (r.status === 'FLAGGED' || r.proctorViolations >= 3) {\r\n                    row.push('MALPRACTICE');\r\n                } else if (r.isAttended || r.status === 'Present') {\r\n                    // Present with minor violations (1-2)\r\n                    if (r.proctorViolations && r.proctorViolations > 0) {\r\n                        row.push(`PRESENT (${r.proctorViolations} FLAG${r.proctorViolations > 1 ? 'S' : ''})`);\r\n                    } else if (r.isOnSpot) {\r\n                        // On-Spot Registration marking\r\n                        row.push('PRESENT (ON-SPOT)');\r\n                    } else {\r\n                        row.push('PRESENT');\r\n                    }\r\n                } else {\r\n                    row.push('ABSENT');\r\n                }\r\n            }\r\n            return row;\r\n        });\r\n\r\n        try {\r\n            const doc = new jsPDF('l', 'mm', 'a4');\r\n            const pageWidth = doc.internal.pageSize.width;\r\n\r\n\r\n            const loadImg = (path) => new Promise(res => {\r\n                const img = new Image();\r\n                img.onload = () => res(img);\r\n                img.onerror = () => res(null);\r\n                img.src = path;\r\n            });\r\n            const [rit, ts] = await Promise.all([loadImg(ritLogo), loadImg(techsparkLogo)]);\r\n\r\n            // Professional Sidebar & Header\r\n            doc.setFillColor(15, 23, 42);\r\n            doc.rect(0, 0, 5, 210, 'F');\r\n            if (rit) doc.addImage(rit, 'PNG', 12, 10, 48, 15);\r\n            if (ts) doc.addImage(ts, 'PNG', pageWidth - 60, 10, 45, 15);\r\n            doc.setDrawColor(226, 232, 240);\r\n            doc.line(12, 30, pageWidth - 12, 30);\r\n\r\n            // Title Block\r\n            doc.setTextColor(30, 41, 59);\r\n            doc.setFont('helvetica', 'bold');\r\n            doc.setFontSize(16);\r\n            doc.text(title, pageWidth / 2, 45, { align: 'center' });\r\n\r\n            doc.setFontSize(10);\r\n            doc.setFont('helvetica', 'bold');\r\n            doc.text(event.title.toUpperCase(), pageWidth / 2, 52, { align: 'center' });\r\n\r\n            doc.setFontSize(7);\r\n            doc.setFont('helvetica', 'normal');\r\n            doc.setTextColor(150);\r\n            doc.text(`GENERATED BY: ${(organizer?.fullName || 'CENTRAL ORGANIZER').toUpperCase()} | REF: ORG-LOG-${Math.floor(Math.random() * 10000)}`, pageWidth / 2, 58, { align: 'center' });\r\n            doc.text(`EXTRACTION LOGGED: ${new Date().toLocaleString().toUpperCase()}`, pageWidth / 2, 62, { align: 'center' });\r\n\r\n            // DUPLICATE Watermark\r\n            doc.saveGraphicsState();\r\n            doc.setGState(new doc.GState({ opacity: 0.1 }));\r\n            doc.setTextColor(200, 0, 0);\r\n            doc.setFontSize(60);\r\n            doc.text('DUPLICATE', pageWidth / 2, 150, { align: 'center', angle: -45 });\r\n            doc.setFontSize(15);\r\n            doc.text('FOR INTERNAL COORDINATION ONLY', pageWidth / 2, 165, { align: 'center', angle: -45 });\r\n            doc.restoreGraphicsState();\r\n\r\n            // Executive Summary\r\n            autoTable(doc, {\r\n                startY: 70,\r\n                head: [['EXECUTIVE SUMMARY METRIC', 'OPERATIONAL DATA']],\r\n                body: summaryMetrics,\r\n                theme: 'striped',\r\n                headStyles: { fillColor: [71, 85, 105], fontSize: 8 },\r\n                bodyStyles: { fontSize: 8, fontStyle: 'bold' },\r\n                columnStyles: { 0: { cellWidth: 60 } },\r\n                margin: { left: 15, right: 15 }\r\n            });\r\n\r\n            // Participant Directory\r\n            autoTable(doc, {\r\n                startY: doc.lastAutoTable.finalY + 10,\r\n                head: tableHead,\r\n                body: tableData,\r\n                headStyles: { fillColor: type === 'ATTENDANCE' ? [16, 185, 129] : [15, 23, 42], fontSize: 7, fontStyle: 'bold' },\r\n                bodyStyles: { fontSize: 6.5 },\r\n                alternateRowStyles: { fillColor: [248, 250, 252] },\r\n                margin: { left: 10, right: 10 },\r\n                didParseCell: (data) => {\r\n                    if (data.section === 'body' && data.cell.text[0] === 'ABSENT') {\r\n                        data.cell.styles.textColor = [220, 38, 38]; // Red\r\n                        data.cell.styles.fontStyle = 'bold';\r\n                    }\r\n                    if (data.section === 'body' && data.cell.text[0] === 'MALPRACTICE') {\r\n                        data.cell.styles.textColor = [234, 88, 12]; // Orange\r\n                        data.cell.styles.fillColor = [254, 243, 199]; // Light orange bg\r\n                        data.cell.styles.fontStyle = 'bold';\r\n                    }\r\n                    if (data.section === 'body' && data.cell.text[0]?.includes('ON-SPOT')) {\r\n                        data.cell.styles.textColor = [37, 99, 235]; // Blue\r\n                        data.cell.styles.fillColor = [219, 234, 254]; // Light blue bg\r\n                        data.cell.styles.fontStyle = 'bold';\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Standard Footer\r\n            const pages = doc.internal.getNumberOfPages();\r\n            for (let i = 1; i <= pages; i++) {\r\n                doc.setPage(i);\r\n                doc.setFontSize(7);\r\n                doc.setTextColor(160);\r\n                doc.text('AUTHORIZED ORGANIZER EXTRACT | DUPLICATE COPY | TECHSPARK CLUB', pageWidth / 2, 200, { align: 'center' });\r\n            }\r\n\r\n            doc.save(`${event.title.replace(/\\s+/g, '_')}_${filenameSuffix}_DUPLICATE.pdf`);\r\n        } catch (error) {\r\n            console.error(\"PDF Export Error:\", error);\r\n            alert(\"Strategic extraction failed.\");\r\n        }\r\n    };\r\n\r\n\r\n\r\n    if (!organizer) {\r\n        return (\r\n            <div className=\"min-h-screen bg-[#0f172a] flex items-center justify-center\">\r\n                <div className=\"text-center space-y-4\">\r\n                    <div className=\"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto\" />\r\n                    <p className=\"text-slate-400 font-black text-[10px] uppercase tracking-widest\">Validating Tactical Credentials...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const renderStepIndicator = () => (\r\n        <div className=\"flex items-center justify-between mb-8 md:mb-12 px-2 md:px-0\">\r\n            {[1, 2, 3, 4].map((step) => (\r\n                <div key={step} className=\"flex items-center flex-1 last:flex-none\">\r\n                    <div className={`w-8 h-8 md:w-10 md:h-10 rounded-lg md:rounded-xl flex items-center justify-center font-bold text-xs md:text-sm transition-all duration-300 ${activeStep === step\r\n                        ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/30'\r\n                        : activeStep > step ? 'bg-emerald-500 text-white' : 'bg-white border border-slate-200 text-slate-400'\r\n                        }`}>\r\n                        {activeStep > step ? <CheckCircle className=\"w-4 h-4 md:w-5 md:h-5\" /> : step}\r\n                    </div>\r\n                    {step < 4 && (\r\n                        <div className={`h-0.5 flex-1 mx-2 md:mx-4 rounded-full ${activeStep > step ? 'bg-emerald-500' : 'bg-slate-200'}`} />\r\n                    )}\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 flex flex-col lg:flex-row\">\r\n            {/* Mobile Header */}\r\n            <header className=\"lg:hidden bg-[#0f172a] text-white p-4 flex items-center justify-between sticky top-0 z-[60] shadow-md\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Shield className=\"w-6 h-6 text-blue-500\" />\r\n                    <h2 className=\"text-lg font-black uppercase italic tracking-tighter\">TechSpark</h2>\r\n                </div>\r\n                <button\r\n                    onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}\r\n                    className=\"p-2 hover:bg-white/10 rounded-xl transition-colors\"\r\n                >\r\n                    {isMobileMenuOpen ? <X className=\"w-6 h-6\" /> : <Menu className=\"w-6 h-6\" />}\r\n                </button>\r\n            </header>\r\n\r\n            {/* Mobile Backdrop */}\r\n            <AnimatePresence>\r\n                {isMobileMenuOpen && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={() => setIsMobileMenuOpen(false)}\r\n                        className=\"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-40 lg:hidden\"\r\n                    />\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* SaaS Dark Sidebar */}\r\n            <aside className={`\r\n                w-72 lg:w-80 bg-[#0f172a] flex flex-col fixed lg:sticky shadow-2xl z-50 transition-transform duration-300\r\n                ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'}\r\n                top-[64px] lg:top-0 h-[calc(100vh-64px)] lg:h-screen lg:inset-y-0\r\n            `}>\r\n                <div className=\"p-8 flex items-center gap-4 mb-8\">\r\n                    <div className=\"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                        <Shield className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <div>\r\n                        <h2 className=\"text-xl font-black text-white tracking-tighter uppercase italic\">TechSpark</h2>\r\n                        <p className=\"text-[10px] text-slate-500 font-bold tracking-[0.2em] uppercase\">Control Center</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <nav className=\"space-y-1.5 px-4 flex-1 overflow-y-auto custom-scrollbar\">\r\n                    {[\r\n                        { id: 'dashboard', label: 'Dashboard', icon: <LayoutDashboard className=\"w-5 h-5\" /> },\r\n                        { id: 'create', label: 'Create Event', icon: <Plus className=\"w-5 h-5\" /> },\r\n                        { id: 'my_events', label: 'My Events', icon: <Briefcase className=\"w-5 h-5\" /> },\r\n                        { id: 'registrations', label: 'Registrations', icon: <Users className=\"w-5 h-5\" /> },\r\n                        { id: 'submissions', label: 'Live Scores', icon: <Activity className=\"w-5 h-5\" /> },\r\n                        { id: 'reports', label: 'Reports', icon: <TrendingUp className=\"w-5 h-5\" /> },\r\n                        { id: 'profile', label: 'Profile', icon: <UserCog className=\"w-5 h-5\" /> },\r\n                    ].map((item) => (\r\n                        <button\r\n                            key={item.id}\r\n                            onClick={() => {\r\n                                setCurrentView(item.id);\r\n                                setIsMobileMenuOpen(false); // Close on selection on mobile\r\n                                if (item.id === 'create') {\r\n                                    setActiveStep(1);\r\n                                    setSelectedEvent(null);\r\n                                    setEditingEventId(null);\r\n                                    // Reset form for new event\r\n                                    setFormData({\r\n                                        title: '', type: 'Workshop', shortDescription: '', detailedDescription: '', posterUrl: '',\r\n                                        startDate: '', startTime: '', endDate: '', endTime: '', venueType: 'Offline', venueName: '', googleMapLink: '',\r\n                                        audienceType: 'Whole College', departments: [], years: [], sections: [],\r\n                                        registrationRequired: true, regStartDateTime: '', regEndDateTime: '', maxParticipants: '', waitingList: false,\r\n                                        coordinatorName: '', coordinatorPhone: '', coordinatorEmail: '', displayCoordinator: true,\r\n                                        terms: '', acceptedTerms: false, internalNotes: ''\r\n                                    });\r\n                                }\r\n                                if (item.id !== 'dashboard') setSelectedEvent(null);\r\n                            }}\r\n                            className={`w-full flex items-center gap-3 px-6 py-4 rounded-2xl font-bold text-sm transition-all text-left ${currentView === item.id ? 'bg-blue-600 text-white shadow-lg shadow-blue-600/20' : 'text-slate-400 hover:bg-white/5'\r\n                                }`}\r\n                        >\r\n                            {item.icon} {item.label}\r\n                        </button>\r\n                    ))}\r\n                </nav>\r\n\r\n                <div className=\"mt-auto p-8 space-y-4 border-t border-white/5 bg-[#0f172a]\">\r\n                    <div className=\"flex items-center gap-4 p-4 bg-white/5 rounded-2xl border border-white/5\">\r\n                        <div className=\"w-10 h-10 bg-slate-800 rounded-xl flex items-center justify-center text-slate-400 font-black italic\">\r\n                            {organizer.username.charAt(0).toUpperCase()}\r\n                        </div>\r\n                        <div className=\"min-w-0\">\r\n                            <p className=\"text-xs font-black text-white truncate uppercase italic\">{organizer.username}</p>\r\n                            <p className=\"text-[9px] text-slate-500 font-bold uppercase tracking-widest\">Active Lead</p>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={handleLogout}\r\n                        className=\"w-full flex items-center justify-center gap-3 py-4 text-slate-500 font-bold text-xs hover:text-red-400 transition-colors uppercase tracking-widest border border-white/5 rounded-xl hover:bg-white/5\"\r\n                    >\r\n                        <LogOut className=\"w-4 h-4\" /> Sign Termination\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content Area */}\r\n            <main className=\"flex-1 overflow-y-auto min-h-screen\">\r\n                <div className=\"max-w-7xl mx-auto p-4 md:p-8 lg:p-12\">\r\n                    <AnimatePresence mode=\"wait\">\r\n                        {currentView === 'dashboard' ? (\r\n                            <motion.div key=\"dashboard\" initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }}>\r\n                                <div className=\"space-y-12 text-left\">\r\n                                    <header>\r\n                                        <h1 className=\"text-3xl md:text-5xl font-black text-slate-900 tracking-tighter uppercase italic mb-2 pt-4 md:pt-0\">Tactical <span className=\"text-blue-600\">Overview</span></h1>\r\n                                        <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[10px] md:text-xs\">Organizer Mission Intelligence Portal</p>\r\n                                    </header>\r\n\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6\">\r\n                                        {[\r\n                                            { label: 'Total Missions', val: stats.total, icon: <Briefcase className=\"w-5 h-5\" />, color: 'blue' },\r\n                                            { label: 'Pending', val: stats.pending, icon: <Clock className=\"w-5 h-5\" />, color: 'orange' },\r\n                                            { label: 'Live', val: stats.live, icon: <ShieldCheck className=\"w-5 h-5\" />, color: 'emerald' },\r\n                                            { label: 'Total Regs', val: stats.totalRegs, icon: <Users className=\"w-5 h-5\" />, color: 'indigo' }\r\n                                        ].map((s, i) => (\r\n                                            <div key={i} className=\"bg-white p-6 md:p-8 rounded-[1.5rem] md:rounded-[2rem] border border-slate-100 shadow-sm flex items-center gap-4 md:gap-6\">\r\n                                                <div className={`w-12 h-12 md:w-14 md:h-14 bg-${s.color}-50 text-${s.color}-600 rounded-xl md:rounded-2xl flex items-center justify-center shadow-inner shrink-0`}>\r\n                                                    {s.icon}\r\n                                                </div>\r\n                                                <div>\r\n                                                    <p className=\"text-[9px] md:text-[10px] text-slate-400 font-black uppercase tracking-widest mb-1\">{s.label}</p>\r\n                                                    <h3 className=\"text-2xl md:text-3xl font-black text-slate-900 tabular-nums\">{s.val}</h3>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n                                        <div className=\"lg:col-span-2 bg-white border border-slate-200 rounded-[2rem] md:rounded-[2.5rem] p-6 md:p-8\">\r\n                                            <div className=\"flex items-center justify-between mb-8\">\r\n                                                <h3 className=\"text-[10px] md:text-[11px] text-slate-400 font-black uppercase tracking-[0.2em]\">Recent Operations</h3>\r\n                                                <button onClick={() => setCurrentView('my_events')} className=\"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:underline\">View All Registry</button>\r\n                                            </div>\r\n                                            <div className=\"space-y-4\">\r\n                                                {events.slice(0, 3).map(event => (\r\n                                                    <div key={event.id} className=\"p-4 bg-slate-50 border border-slate-100 rounded-2xl flex items-center justify-between group cursor-pointer hover:bg-white transition-all overflow-hidden\" onClick={() => { setSelectedEvent(event); setCurrentView('my_events'); }}>\r\n                                                        <div className=\"flex items-center gap-3 md:gap-4 overflow-hidden\">\r\n                                                            <div className=\"w-8 h-8 md:w-10 md:h-10 bg-white rounded-xl flex items-center justify-center font-black text-slate-300 group-hover:text-blue-600 border border-slate-100 shrink-0\">{event.title.charAt(0)}</div>\r\n                                                            <div className=\"truncate\">\r\n                                                                <h4 className=\"text-xs md:text-sm font-black text-slate-800 uppercase italic leading-none mb-1 truncate\">{event.title}</h4>\r\n                                                                <p className=\"text-[9px] md:text-[10px] text-slate-400 font-bold uppercase\">{event.date}</p>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <span className={`px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-widest shrink-0 ${event.status === 'LIVE' ? 'bg-emerald-50 text-emerald-600' : 'bg-orange-50 text-orange-600'\r\n                                                            }`}>{event.status}</span>\r\n                                                    </div>\r\n                                                ))}\r\n                                                {events.length === 0 && <p className=\"text-center py-8 text-[10px] text-slate-400 font-bold italic uppercase\">No operations documented.</p>}\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"bg-slate-900 border border-slate-800 rounded-[2rem] md:rounded-[2.5rem] p-6 md:p-8 text-white\">\r\n                                            <h3 className=\"text-[10px] md:text-[11px] text-slate-500 font-black uppercase tracking-[0.2em] mb-6\">Authorization Alerts</h3>\r\n                                            <div className=\"space-y-4\">\r\n                                                {events.filter(e => e.status === 'REJECTED').slice(0, 2).map(e => (\r\n                                                    <div key={e.id} className=\"p-4 bg-red-500/10 border border-red-500/20 rounded-2xl\">\r\n                                                        <p className=\"text-[9px] font-black text-red-500 uppercase mb-1\">REJECTED: {e.title}</p>\r\n                                                        <p className=\"text-[10px] text-slate-400 font-medium line-clamp-2 italic\">\"{e.remarks}\"</p>\r\n                                                    </div>\r\n                                                ))}\r\n                                                {events.filter(e => e.status === 'PENDING').length > 0 && (\r\n                                                    <div className=\"p-4 bg-orange-500/10 border border-orange-500/20 rounded-2xl\">\r\n                                                        <p className=\"text-[9px] font-black text-orange-500 uppercase mb-1\">PENDING AUTHORIZATION</p>\r\n                                                        <p className=\"text-[10px] text-slate-400 font-medium italic\">{events.filter(e => e.status === 'PENDING').length} missions awaiting review.</p>\r\n                                                    </div>\r\n                                                )}\r\n                                                {events.filter(e => e.status === 'REJECTED').length === 0 && events.filter(e => e.status === 'PENDING').length === 0 && (\r\n                                                    <div className=\"h-32 flex flex-col items-center justify-center border-2 border-dashed border-slate-800 rounded-2xl opacity-40\">\r\n                                                        <CheckCircle className=\"w-8 h-8 mb-2\" />\r\n                                                        <p className=\"text-[10px] font-black uppercase\">All Clear</p>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : currentView === 'my_events' ? (\r\n                            <motion.div key=\"my_events\" initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }}>\r\n                                {selectedEvent ? (\r\n                                    <div className=\"space-y-12 text-left\">\r\n                                        <header className=\"flex flex-col md:flex-row md:items-center justify-between gap-6 pb-8 border-b border-slate-200\">\r\n                                            <div className=\"flex items-center gap-4 md:gap-6\">\r\n                                                <button onClick={() => setSelectedEvent(null)} className=\"w-10 h-10 md:w-12 md:h-12 bg-white border border-slate-200 rounded-xl flex items-center justify-center text-slate-400 hover:text-slate-900 transition-all shadow-sm shrink-0\">\r\n                                                    <ChevronLeft className=\"w-5 h-5 md:w-6 md:h-6\" />\r\n                                                </button>\r\n                                                <div>\r\n                                                    <div className=\"flex items-center gap-2 mb-1\">\r\n                                                        <span className=\"px-2 md:px-2.5 py-1 bg-blue-50 text-blue-600 text-[8px] md:text-[10px] font-black rounded-lg uppercase tracking-widest\">{selectedEvent.type}</span>\r\n                                                        <span className={`px-2 md:px-2.5 py-1 text-[8px] md:text-[10px] font-black rounded-lg uppercase tracking-widest ${selectedEvent.status === 'LIVE' ? 'bg-emerald-50 text-emerald-600' : 'bg-orange-50 text-orange-600'\r\n                                                            }`}>{selectedEvent.status}</span>\r\n                                                    </div>\r\n                                                    <h1 className=\"text-xl md:text-3xl font-black text-slate-900 tracking-tighter uppercase italic line-clamp-1\">{selectedEvent.title}</h1>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"flex flex-wrap items-center gap-2 md:gap-3\">\r\n                                                {selectedEvent.status === 'LIVE' && (\r\n                                                    <div className=\"flex flex-wrap items-center gap-2 md:gap-3 w-full md:w-auto\">\r\n                                                        <button\r\n                                                            onClick={() => navigate('/checkin')}\r\n                                                            className=\"flex-1 md:flex-none px-4 md:px-6 py-3 md:py-3.5 bg-blue-600 text-white rounded-xl md:rounded-2xl font-black text-[10px] md:text-xs shadow-xl shadow-blue-500/20 hover:bg-blue-700 transition-all flex items-center justify-center gap-2 uppercase tracking-widest\"\r\n                                                        >\r\n                                                            <QrCode className=\"w-4 h-4 md:w-5 md:h-5\" /> <span className=\"hidden sm:inline\">Launch</span> Terminal\r\n                                                        </button>\r\n\r\n                                                        {/* Quiz Toggle in Header */}\r\n                                                        {selectedEvent.type?.toLowerCase() === 'quiz' && (\r\n                                                            selectedEvent.quizEnabled ? (\r\n                                                                <button\r\n                                                                    onClick={() => handleDisableQuiz(selectedEvent.id)}\r\n                                                                    className=\"px-6 py-3.5 bg-red-500 text-white rounded-2xl font-black text-xs shadow-xl shadow-red-500/20 hover:bg-red-600 transition-all flex items-center gap-2 uppercase tracking-widest\"\r\n                                                                >\r\n                                                                    ≡ƒÜ½ Disable Quiz\r\n                                                                </button>\r\n                                                            ) : (\r\n                                                                <button\r\n                                                                    onClick={() => handleEnableQuiz(selectedEvent.id)}\r\n                                                                    className=\"px-6 py-3.5 bg-emerald-600 text-white rounded-2xl font-black text-xs shadow-xl shadow-emerald-500/20 hover:bg-emerald-700 transition-all flex items-center gap-2 uppercase tracking-widest\"\r\n                                                                >\r\n                                                                    Γ£à Enable Quiz\r\n                                                                </button>\r\n                                                            )\r\n                                                        )}\r\n                                                    </div>\r\n                                                )}\r\n                                                <button\r\n                                                    onClick={() => {\r\n                                                        setExportType('REGISTRATION');\r\n                                                        setIsExportModalOpen(true);\r\n                                                    }}\r\n                                                    disabled={registrations.length === 0}\r\n                                                    className=\"flex-1 md:flex-none px-4 md:px-6 py-3 md:py-3.5 bg-slate-900 text-white rounded-xl md:rounded-2xl font-black text-[10px] md:text-xs shadow-xl shadow-slate-900/10 hover:bg-black transition-all flex items-center justify-center gap-2 uppercase tracking-widest disabled:opacity-30\"\r\n                                                >\r\n                                                    <FileText className=\"w-4 h-4 md:w-5 md:h-5\" /> <span className=\"hidden sm:inline\">Register</span> Report\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => {\r\n                                                        setExportType('ATTENDANCE');\r\n                                                        setIsExportModalOpen(true);\r\n                                                    }}\r\n                                                    disabled={registrations.length === 0}\r\n                                                    className=\"flex-1 md:flex-none px-4 md:px-6 py-3 md:py-3.5 bg-emerald-600 text-white rounded-xl md:rounded-2xl font-black text-[10px] md:text-xs shadow-xl shadow-emerald-500/10 hover:bg-emerald-700 transition-all flex items-center justify-center gap-2 uppercase tracking-widest disabled:opacity-30\"\r\n                                                >\r\n                                                    <ShieldCheck className=\"w-4 h-4 md:w-5 md:h-5\" /> <span className=\"hidden sm:inline\">Attendee</span> Report\r\n                                                </button>\r\n                                            </div>\r\n                                        </header>\r\n\r\n                                        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\r\n                                            <div className=\"lg:col-span-1 space-y-6\">\r\n                                                <div className=\"bg-white border border-slate-200 rounded-[2.5rem] p-8 shadow-sm\">\r\n                                                    <h3 className=\"text-[11px] text-slate-400 font-black uppercase tracking-[0.2em] mb-6\">Metrics & Logistics</h3>\r\n                                                    <div className=\"space-y-4\">\r\n                                                        <div className=\"p-5 bg-slate-50 rounded-2xl border border-slate-100\">\r\n                                                            <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1 flex items-center gap-2\"><Clock className=\"w-3.5 h-3.5\" /> Timeline</p>\r\n                                                            <p className=\"text-sm font-black text-slate-800 uppercase\">{selectedEvent.date}</p>\r\n                                                        </div>\r\n                                                        <div className=\"p-5 bg-slate-50 rounded-2xl border border-slate-100\">\r\n                                                            <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1 flex items-center gap-2\"><MapPin className=\"w-3.5 h-3.5\" /> Strategic Venue</p>\r\n                                                            <p className=\"text-sm font-black text-slate-800 uppercase\">{selectedEvent.venue}</p>\r\n                                                        </div>\r\n                                                        <div className=\"p-6 bg-slate-900 rounded-3xl shadow-xl shadow-slate-900/10 text-white\">\r\n                                                            <p className=\"text-[10px] text-slate-500 font-bold uppercase tracking-widest mb-4\">Registration Velocity</p>\r\n                                                            <div className=\"flex items-end justify-between mb-4\">\r\n                                                                <h4 className=\"text-3xl font-black italic\">{registrations.length}</h4>\r\n                                                                <p className=\"text-xs font-bold text-slate-500 uppercase tracking-widest\">OF {selectedEvent.maxParticipants}</p>\r\n                                                            </div>\r\n                                                            <div className=\"h-2 bg-white/10 rounded-full overflow-hidden\">\r\n                                                                <motion.div initial={{ width: 0 }} animate={{ width: `${Math.min((registrations.length / selectedEvent.maxParticipants) * 100, 100)}%` }} className=\"h-full bg-blue-500\" />\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"lg:col-span-3\">\r\n                                                <div className=\"bg-white border border-slate-200 rounded-[2.5rem] shadow-sm overflow-hidden h-full flex flex-col\">\r\n                                                    {/* Search & Filter Bar */}\r\n                                                    <div className=\"p-4 md:p-6 border-b border-slate-100 space-y-4\">\r\n                                                        <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-2\">\r\n                                                            <h3 className=\"text-[10px] md:text-[11px] text-slate-400 font-black uppercase tracking-[0.2em]\">Participants Registry</h3>\r\n                                                            <div className=\"flex items-center gap-2 md:gap-3\">\r\n                                                                <span className=\"px-2 py-0.5 md:px-3 md:py-1 bg-blue-50 text-blue-600 text-[8px] md:text-[10px] font-bold rounded-full\">\r\n                                                                    {registrations.length} Total\r\n                                                                </span>\r\n                                                                {regSearchQuery || regDeptFilter !== 'all' || regYearFilter !== 'all' ? (\r\n                                                                    <span className=\"px-3 py-1 bg-slate-100 text-slate-600 text-[10px] font-bold rounded-full\">\r\n                                                                        {getFilteredRegistrations().length} Filtered\r\n                                                                    </span>\r\n                                                                ) : null}\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        {/* Search Input */}\r\n                                                        <div className=\"flex flex-col md:flex-row md:items-center gap-3 md:gap-4\">\r\n                                                            <div className=\"flex-1 relative\">\r\n                                                                <input\r\n                                                                    type=\"text\"\r\n                                                                    placeholder=\"Search name/roll...\"\r\n                                                                    value={regSearchQuery}\r\n                                                                    onChange={(e) => setRegSearchQuery(e.target.value)}\r\n                                                                    className=\"w-full px-4 py-2.5 md:px-5 md:py-3 pl-10 md:pl-12 pr-10 bg-slate-50 border border-slate-200 rounded-xl text-xs sm:text-sm font-bold text-slate-800 outline-none focus:ring-2 focus:ring-blue-500/20 transition-all\"\r\n                                                                />\r\n                                                                <Search className=\"absolute left-3.5 md:left-4 top-1/2 -translate-y-1/2 w-3.5 h-3.5 md:w-4 md:h-4 text-slate-400\" />\r\n                                                                <button\r\n                                                                    onClick={() => setIsScannerOpen(true)}\r\n                                                                    className=\"absolute right-3.5 md:right-4 top-1/2 -translate-y-1/2 p-1 bg-white shadow-sm border border-slate-200 rounded-lg text-slate-400 hover:text-blue-600 transition-colors\"\r\n                                                                    title=\"Scan QR to Find\"\r\n                                                                >\r\n                                                                    <QrCode className=\"w-3.5 h-3.5 md:w-4 md:h-4\" />\r\n                                                                </button>\r\n                                                            </div>\r\n\r\n                                                            <div className=\"flex gap-2\">\r\n                                                                <select\r\n                                                                    value={regDeptFilter}\r\n                                                                    onChange={(e) => setRegDeptFilter(e.target.value)}\r\n                                                                    className=\"flex-1 md:flex-none px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-[10px] md:text-xs font-bold text-slate-600 outline-none focus:ring-2 focus:ring-blue-500/20 uppercase\"\r\n                                                                >\r\n                                                                    <option value=\"all\">Depts</option>\r\n                                                                    {getUniqueValues('studentDept').map(dept => (\r\n                                                                        <option key={dept} value={dept}>{dept}</option>\r\n                                                                    ))}\r\n                                                                </select>\r\n\r\n                                                                <select\r\n                                                                    value={regYearFilter}\r\n                                                                    onChange={(e) => setRegYearFilter(e.target.value)}\r\n                                                                    className=\"flex-1 md:flex-none px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-[10px] md:text-xs font-bold text-slate-600 outline-none focus:ring-2 focus:ring-blue-500/20 uppercase\"\r\n                                                                >\r\n                                                                    <option value=\"all\">Years</option>\r\n                                                                    {getUniqueValues('studentYear').map(year => (\r\n                                                                        <option key={year} value={year}>{year} Yr</option>\r\n                                                                    ))}\r\n                                                                </select>\r\n                                                            </div>\r\n\r\n                                                            {selectedEvent?.type === 'Quiz' && (\r\n                                                                <button\r\n                                                                    onClick={() => setShowFlaggedOnly(!showFlaggedOnly)}\r\n                                                                    className={`px-4 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center justify-center gap-2 border ${showFlaggedOnly ? 'bg-red-500 text-white border-red-500 shadow-lg shadow-red-500/20' : 'bg-slate-50 text-slate-500 border-slate-200'}`}\r\n                                                                >\r\n                                                                    ≡ƒÜ⌐ {showFlaggedOnly ? 'FLAGGED' : 'SHOW FLAGGED'}\r\n                                                                </button>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    {/* Participant List */}\r\n                                                    <div className=\"p-6 overflow-y-auto flex-1 max-h-[500px] space-y-3 custom-scrollbar\">\r\n                                                        {loadingRegs ? (\r\n                                                            <div className=\"h-64 flex flex-col items-center justify-center gap-4 opacity-40\">\r\n                                                                <div className=\"w-10 h-10 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\r\n                                                                <p className=\"text-[10px] font-black uppercase tracking-[0.2em]\">Accessing Directory...</p>\r\n                                                            </div>\r\n                                                        ) : getFilteredRegistrations().length > 0 ? getFilteredRegistrations().map((reg) => (\r\n                                                            <div key={reg.id} className=\"p-4 md:p-5 bg-slate-50 border border-slate-100 rounded-2xl flex flex-col sm:flex-row sm:items-center justify-between gap-4 group hover:border-blue-200 hover:bg-blue-50/10 transition-all\">\r\n                                                                <div className=\"flex items-center gap-3 md:gap-5\">\r\n                                                                    <div className=\"w-10 h-10 md:w-12 md:h-12 rounded-xl flex items-center justify-center text-base md:text-lg font-black bg-white border border-slate-200 text-slate-400 group-hover:text-blue-600 transition-all shrink-0\">\r\n                                                                        {reg.studentName?.charAt(0) || '?'}\r\n                                                                    </div>\r\n                                                                    <div>\r\n                                                                        <div className=\"flex items-center gap-3\">\r\n                                                                            <h4 className=\"text-sm font-black text-slate-800 uppercase italic tracking-tight\">{reg.studentName}</h4>\r\n                                                                            {(reg.status === 'Present' || reg.isAttended) && (\r\n                                                                                <span className=\"px-2 py-0.5 bg-emerald-500 text-white text-[8px] font-black rounded uppercase tracking-widest\">\r\n                                                                                    CHECKED-IN\r\n                                                                                </span>\r\n                                                                            )}\r\n                                                                            {/* Proctoring FLAG Indicator - Only for Quiz Events */}\r\n                                                                            {selectedEvent?.type === 'Quiz' && (reg.status === 'FLAGGED' || reg.proctorViolations > 0) && (\r\n                                                                                <span className=\"px-2 py-0.5 bg-red-500 text-white text-[8px] font-black rounded uppercase tracking-widest flex items-center gap-1 animate-pulse\">\r\n                                                                                    ≡ƒÜ⌐ FLAGGED {reg.proctorViolations ? `(${reg.proctorViolations})` : ''}\r\n                                                                                </span>\r\n                                                                            )}\r\n                                                                        </div>\r\n                                                                        <div className=\"flex flex-wrap items-center gap-x-2 gap-y-1 text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1\">\r\n                                                                            <span className=\"text-blue-600\">{reg.studentRoll}</span>\r\n                                                                            <span className=\"w-1 h-1 bg-slate-300 rounded-full\" />\r\n                                                                            <span>{reg.studentDept}</span>\r\n                                                                            <span className=\"w-1 h-1 bg-slate-300 rounded-full\" />\r\n                                                                            <span>{reg.studentYear} Year</span>\r\n                                                                            {reg.isTeamRegistration && (\r\n                                                                                <>\r\n                                                                                    <span className=\"w-1 h-1 bg-blue-300 rounded-full\" />\r\n                                                                                    <span className=\"text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded italic\">\r\n                                                                                        Squad: {reg.teamName} ({reg.teamRole})\r\n                                                                                    </span>\r\n                                                                                </>\r\n                                                                            )}\r\n                                                                            {selectedEvent?.type === 'Hackathon' && reg.problemStatement && (\r\n                                                                                <>\r\n                                                                                    <span className=\"w-1 h-1 bg-purple-300 rounded-full\" />\r\n                                                                                    <span className=\"text-purple-600 bg-purple-50 px-1.5 py-0.5 rounded border border-purple-100 flex items-center gap-1\">\r\n                                                                                        <Zap className=\"w-2.5 h-2.5\" /> {reg.problemStatement}\r\n                                                                                    </span>\r\n                                                                                </>\r\n                                                                            )}\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                </div>\r\n\r\n                                                                {/* Participant Actions - Only show if event is NOT completed */}\r\n                                                                {selectedEvent?.status !== 'COMPLETED' ? (\r\n                                                                    <div className=\"flex items-center gap-2 w-full sm:w-auto\">\r\n                                                                        {/* Remove Flag Button - Only for Quiz Events with Flagged Students */}\r\n                                                                        {selectedEvent?.type === 'Quiz' && (reg.status === 'FLAGGED' || reg.proctorViolations > 0) && (\r\n                                                                            <button\r\n                                                                                onClick={() => handleRemoveFlag(reg.id, reg.studentName)}\r\n                                                                                className=\"flex-1 sm:flex-none px-3 md:px-4 py-2 md:py-3 rounded-xl md:rounded-2xl text-[8px] md:text-[10px] font-black uppercase tracking-widest bg-amber-50 text-amber-600 hover:bg-amber-100 transition-all flex items-center justify-center gap-2 border border-amber-100\"\r\n                                                                            >\r\n                                                                                ≡ƒöä <span className=\"hidden xs:inline\">REMOVE</span> FLAG\r\n                                                                            </button>\r\n                                                                        )}\r\n                                                                        {(reg.status === 'Present' || reg.isAttended) && (\r\n                                                                            <button\r\n                                                                                onClick={() => handleUndoCheckIn(reg.id)}\r\n                                                                                className=\"flex-1 sm:flex-none px-3 md:px-4 py-2 md:py-3 rounded-xl md:rounded-2xl text-[8px] md:text-[10px] font-black uppercase tracking-widest bg-emerald-50 text-emerald-600 hover:bg-emerald-100 transition-all flex items-center justify-center gap-2 border border-emerald-100\"\r\n                                                                            >\r\n                                                                                <RotateCcw className=\"w-3.5 h-3.5 md:w-4 md:h-4\" /> <span className=\"hidden xs:inline\">UNDO</span>\r\n                                                                            </button>\r\n                                                                        )}\r\n                                                                        <button\r\n                                                                            onClick={() => handleDeleteRegistration(reg.id, reg.eventId)}\r\n                                                                            className=\"flex-1 sm:flex-none px-3 md:px-4 py-2 md:py-3 rounded-xl md:rounded-2xl text-[8px] md:text-[10px] font-black uppercase tracking-widest bg-slate-100 text-slate-400 hover:bg-red-50 hover:text-red-600 transition-all flex items-center justify-center gap-2 border border-slate-200\"\r\n                                                                        >\r\n                                                                            <UserMinus className=\"w-3.5 h-3.5 md:w-4 md:h-4\" /> <span className=\"hidden xs:inline\">REMOVE</span>\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                ) : (\r\n                                                                    <div className=\"flex flex-col items-end gap-1\">\r\n                                                                        <span className=\"text-[9px] font-bold text-slate-300 uppercase tracking-widest\">\r\n                                                                            {reg.registeredAt?.toDate ? new Date(reg.registeredAt.toDate()).toLocaleDateString() : 'Registered'}\r\n                                                                        </span>\r\n                                                                        {(reg.status === 'Present' || reg.isAttended) ? (\r\n                                                                            <span className=\"text-[8px] text-emerald-500 font-black uppercase tracking-tighter\">Verified Participation</span>\r\n                                                                        ) : (\r\n                                                                            <span className=\"text-[8px] text-red-500 font-black uppercase tracking-widest\">ABSENT</span>\r\n                                                                        )}\r\n                                                                    </div>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        )) : (\r\n                                                            <div className=\"h-64 flex flex-col items-center justify-center gap-4 opacity-30\">\r\n                                                                <Users className=\"w-12 h-12 text-slate-300\" />\r\n                                                                <p className=\"text-xs font-black uppercase tracking-widest\">\r\n                                                                    {registrations.length === 0 ? 'No Registrations Yet' : 'No Matching Results'}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"space-y-12 text-left\">\r\n                                        <header>\r\n                                            <h1 className=\"text-3xl md:text-4xl font-black text-slate-900 tracking-tighter uppercase italic mb-2\">Operation <span className=\"text-blue-600\">Registry</span></h1>\r\n                                            <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[10px] md:text-xs\">Managing your commissioned missions</p>\r\n                                        </header>\r\n\r\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8\">\r\n                                            {events.map((event) => (\r\n                                                <div key={event.id} className=\"group bg-white border border-slate-200 rounded-[2rem] md:rounded-[3rem] p-6 md:p-8 hover:shadow-2xl hover:shadow-slate-200/50 hover:border-blue-500 transition-all duration-500 flex flex-col relative overflow-hidden\">\r\n                                                    {/* Status Badges */}\r\n                                                    <div className=\"flex items-center justify-between mb-6\">\r\n                                                        <span className=\"px-3 py-1 bg-blue-50 text-blue-600 text-[10px] font-black rounded-lg uppercase tracking-widest\">{event.type}</span>\r\n                                                        <div className=\"flex items-center gap-2\">\r\n                                                            {event.status === 'LIVE' && event.registrationOpen !== false && (\r\n                                                                <span className=\"px-2 py-0.5 bg-green-100 text-green-700 text-[8px] font-black rounded uppercase\">REG OPEN</span>\r\n                                                            )}\r\n                                                            {event.status === 'LIVE' && event.registrationOpen === false && (\r\n                                                                <span className=\"px-2 py-0.5 bg-yellow-100 text-yellow-700 text-[8px] font-black rounded uppercase\">REG CLOSED</span>\r\n                                                            )}\r\n                                                            <span className={`px-3 py-1 text-[10px] font-black rounded-lg uppercase tracking-widest ${event.status === 'LIVE' ? 'bg-emerald-50 text-emerald-600' :\r\n                                                                event.status === 'COMPLETED' ? 'bg-blue-50 text-blue-600' :\r\n                                                                    event.status === 'REJECTED' ? 'bg-red-50 text-red-600' :\r\n                                                                        event.status === 'DRAFT' ? 'bg-slate-100 text-slate-500' :\r\n                                                                            'bg-orange-50 text-orange-600'\r\n                                                                }`}>{event.status}</span>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <h3 className=\"text-2xl font-black text-slate-900 uppercase italic tracking-tighter leading-[1.1] mb-6 min-h-[52px] group-hover:text-blue-600 transition-colors\">{event.title}</h3>\r\n\r\n                                                    <div className=\"space-y-4 mb-8\">\r\n                                                        <div className=\"flex items-center gap-3 text-slate-400 text-[10px] font-black uppercase tracking-widest\">\r\n                                                            <Calendar className=\"w-4 h-4 text-blue-500\" /> {event.date}\r\n                                                        </div>\r\n                                                        <div className=\"flex items-center gap-3 text-emerald-500 text-[10px] font-black uppercase tracking-[0.1em] bg-emerald-50/50 p-2 rounded-xl border border-emerald-100/50\">\r\n                                                            <Activity className=\"w-4 h-4\" />\r\n                                                            <span className=\"tabular-nums\">\r\n                                                                {allRegs.filter(r => r.eventId === event.id && (r.isAttended || r.status === 'Present')).length} IN\r\n                                                            </span>\r\n                                                            <span className=\"text-slate-300 mx-1\">/</span>\r\n                                                            <span className=\"text-slate-400 tabular-nums\">\r\n                                                                {event.attendeesCount || 0} REGS\r\n                                                            </span>\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    <div className=\"mt-auto pt-8 border-t border-slate-100 flex flex-col gap-3\">\r\n                                                        {/* Rejected Event Feedback */}\r\n                                                        {event.status === 'REJECTED' && (\r\n                                                            <div className=\"mb-2 p-3 bg-red-50 rounded-xl border border-red-100\">\r\n                                                                <p className=\"text-[9px] font-black text-red-600 uppercase mb-1\">Admin Feedback</p>\r\n                                                                <p className=\"text-[10px] text-slate-600 font-medium italic\">\"{event.remarks}\"</p>\r\n                                                            </div>\r\n                                                        )}\r\n\r\n                                                        {/* Main Action Button */}\r\n                                                        <button onClick={() => handleViewDetails(event)} className=\"w-full py-4 bg-slate-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-black transition-all flex items-center justify-center gap-2\">\r\n                                                            ACCESS CONSOLE <ArrowRight className=\"w-4 h-4\" />\r\n                                                        </button>\r\n\r\n                                                        {/* Quick Actions Row */}\r\n                                                        <div className=\"flex flex-wrap items-center gap-3 px-1 mt-2\">\r\n                                                            {/* DRAFT/REJECTED: Edit & Resubmit */}\r\n                                                            {(event.status === 'DRAFT' || event.status === 'REJECTED') && (\r\n                                                                <>\r\n                                                                    <button\r\n                                                                        onClick={() => handleEditEvent(event)}\r\n                                                                        className=\"text-[10px] font-black text-indigo-600 uppercase tracking-widest hover:underline flex items-center gap-1\"\r\n                                                                    >\r\n                                                                        <Settings className=\"w-3 h-3\" /> Edit\r\n                                                                    </button>\r\n                                                                    <button onClick={async () => {\r\n                                                                        if (!confirm(\"Submit for authorization?\")) return;\r\n                                                                        await updateDoc(doc(db, 'events', event.id), { status: 'PENDING', remarks: '' });\r\n                                                                    }} className=\"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:underline\">Resubmit</button>\r\n                                                                </>\r\n                                                            )}\r\n\r\n                                                            {/* LIVE: Close/Reopen Registration & Mark Complete */}\r\n                                                            {event.status === 'LIVE' && (\r\n                                                                <>\r\n                                                                    {event.registrationOpen !== false ? (\r\n                                                                        <button\r\n                                                                            onClick={() => handleCloseRegistration(event.id)}\r\n                                                                            className=\"text-[10px] font-black text-orange-600 uppercase tracking-widest hover:underline flex items-center gap-1\"\r\n                                                                        >\r\n                                                                            <X className=\"w-3 h-3\" /> Close Reg\r\n                                                                        </button>\r\n                                                                    ) : (\r\n                                                                        <button\r\n                                                                            onClick={() => handleReopenRegistration(event.id)}\r\n                                                                            className=\"text-[10px] font-black text-green-600 uppercase tracking-widest hover:underline flex items-center gap-1\"\r\n                                                                        >\r\n                                                                            <CheckCircle className=\"w-3 h-3\" /> Reopen Reg\r\n                                                                        </button>\r\n                                                                    )}\r\n                                                                    <button\r\n                                                                        onClick={() => handleMarkComplete(event.id)}\r\n                                                                        className=\"text-[10px] font-black text-purple-600 uppercase tracking-widest hover:underline flex items-center gap-1\"\r\n                                                                    >\r\n                                                                        <CheckCircle className=\"w-3 h-3\" /> Complete\r\n                                                                    </button>\r\n                                                                </>\r\n                                                            )}\r\n                                                        </div>\r\n\r\n                                                        {/* Quiz Enable/Disable Toggle - Prominent Button for Quiz type events */}\r\n                                                        {event.status === 'LIVE' && event.type?.toLowerCase() === 'quiz' && (\r\n                                                            <div className=\"mt-2\">\r\n                                                                {event.quizEnabled ? (\r\n                                                                    <button\r\n                                                                        onClick={() => handleDisableQuiz(event.id)}\r\n                                                                        className=\"w-full py-3 bg-red-100 text-red-600 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-red-200 transition-all flex items-center justify-center gap-2 border border-red-200\"\r\n                                                                    >\r\n                                                                        ≡ƒÜ½ Disable Quiz (Students Cannot Start)\r\n                                                                    </button>\r\n                                                                ) : (\r\n                                                                    <button\r\n                                                                        onClick={() => handleEnableQuiz(event.id)}\r\n                                                                        className=\"w-full py-3 bg-emerald-100 text-emerald-600 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-emerald-200 transition-all flex items-center justify-center gap-2 border border-emerald-200\"\r\n                                                                    >\r\n                                                                        Γ£à Enable Quiz (Allow Students to Start)\r\n                                                                    </button>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        )}\r\n\r\n                                                        {/* COMPLETED: View Feedback */}\r\n                                                        {event.status === 'COMPLETED' && (\r\n                                                            <button\r\n                                                                onClick={() => handleViewFeedback(event.id)}\r\n                                                                className=\"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:underline flex items-center gap-1 mt-4\"\r\n                                                            >\r\n                                                                <Activity className=\"w-3 h-3\" /> Pulse\r\n                                                            </button>\r\n                                                        )}\r\n\r\n                                                        {/* Delete for non-LIVE/non-COMPLETED events */}\r\n                                                        {(event.status === 'DRAFT' || event.status === 'REJECTED') && (\r\n                                                            <button\r\n                                                                onClick={() => handleDeleteEvent(event.id)}\r\n                                                                className=\"text-[10px] font-black text-red-400 uppercase tracking-widest hover:text-red-600 ml-auto mt-4\"\r\n                                                            >\r\n                                                                Delete\r\n                                                            </button>\r\n                                                        )}\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </motion.div>\r\n                        ) : currentView === 'registrations' ? (\r\n                            <motion.div key=\"registrations\" initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }}>\r\n                                <div className=\"space-y-8 text-left\">\r\n                                    <header className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n                                        <div>\r\n                                            <h1 className=\"text-3xl md:text-4xl font-black text-slate-900 tracking-tighter uppercase italic\">Unit <span className=\"text-blue-600\">Oracle</span></h1>\r\n                                            <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[9px] md:text-xs\">Global participant manifest across all operations</p>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                const csv = [['Operation', 'Name', 'Roll Number', 'Branch', 'Year'], ...allRegs.map(r => [r.eventTitle, r.studentName, r.studentRoll, r.studentDept, r.studentYear])].map(e => e.join(\",\")).join(\"\\n\");\r\n                                                const blob = new Blob([csv], { type: 'text/csv' });\r\n                                                const url = window.URL.createObjectURL(blob);\r\n                                                const a = document.createElement('a');\r\n                                                a.setAttribute('href', url);\r\n                                                a.setAttribute('download', 'techspark_manifest.csv');\r\n                                                a.click();\r\n                                            }}\r\n                                            className=\"w-full sm:w-auto px-6 py-3.5 border border-slate-200 text-slate-600 rounded-xl md:rounded-2xl font-black text-[10px] md:text-xs uppercase tracking-widest hover:bg-slate-50 transition-all flex items-center justify-center gap-2\"\r\n                                        >\r\n                                            <Download className=\"w-4 h-4\" /> Export CSV\r\n                                        </button>\r\n                                    </header>\r\n\r\n                                    <div className=\"bg-white border border-slate-200 rounded-[2rem] md:rounded-[2.5rem] shadow-sm overflow-hidden min-h-[500px]\">\r\n                                        <div className=\"overflow-x-auto\">\r\n                                            <table className=\"w-full text-left min-w-[600px]\">\r\n                                                <thead className=\"bg-[#fcfdfe] text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100\">\r\n                                                    <tr>\r\n                                                        <th className=\"px-8 py-6\">Operation Objective</th>\r\n                                                        <th className=\"px-8 py-6\">Unit Signature</th>\r\n                                                        <th className=\"px-8 py-6\">Identity Trace</th>\r\n                                                        <th className=\"px-8 py-6 text-right\">Operational Status</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody className=\"divide-y divide-slate-50\">\r\n                                                    {allRegs.map((reg) => (\r\n                                                        <tr key={reg.id} className=\"hover:bg-slate-50/50 transition-colors group\">\r\n                                                            <td className=\"px-8 py-6\">\r\n                                                                <p className=\"text-sm font-black text-slate-800 uppercase tracking-tight italic\">{reg.eventTitle}</p>\r\n                                                                <p className=\"text-[10px] text-slate-400 font-bold uppercase\">{reg.eventId?.slice(0, 8)}</p>\r\n                                                            </td>\r\n                                                            <td className=\"px-8 py-6 font-black text-slate-700 uppercase italic text-xs\">{reg.studentName}</td>\r\n                                                            <td className=\"px-8 py-6\">\r\n                                                                <p className=\"text-[10px] font-black text-blue-600 uppercase tabular-nums\">{reg.studentRoll}</p>\r\n                                                                <p className=\"text-[9px] text-slate-400 font-bold uppercase\">{reg.studentDept}</p>\r\n                                                            </td>\r\n                                                            <td className=\"px-8 py-6 text-right\">\r\n                                                                <div className=\"flex items-center justify-end gap-3\">\r\n                                                                    {(reg.status === 'Present' || reg.isAttended) ? (\r\n                                                                        <>\r\n                                                                            <span className=\"bg-emerald-50 text-emerald-600 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border border-emerald-100\">VERIFIED</span>\r\n                                                                            <button\r\n                                                                                onClick={() => handleUndoCheckIn(reg.id)}\r\n                                                                                className=\"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-xl transition-all\"\r\n                                                                                title=\"Undo Check-in\"\r\n                                                                            >\r\n                                                                                <X className=\"w-4 h-4\" />\r\n                                                                            </button>\r\n                                                                        </>\r\n                                                                    ) : (\r\n                                                                        <span className=\"bg-slate-50 text-slate-400 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border border-slate-100\">REGISTERED</span>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    ))}\r\n                                                    {allRegs.length === 0 && (\r\n                                                        <tr>\r\n                                                            <td colSpan=\"4\" className=\"px-8 py-20 text-center text-slate-300 font-black uppercase italic text-xs\">Awaiting Global Registrations</td>\r\n                                                        </tr>\r\n                                                    )}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : currentView === 'submissions' ? (\r\n                            <motion.div key=\"submissions\" initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }}>\r\n                                <div className=\"space-y-8 text-left\">\r\n                                    <header className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n                                        <div>\r\n                                            <h1 className=\"text-3xl md:text-4xl font-black text-slate-900 tracking-tighter uppercase italic\">Live <span className=\"text-blue-600\">Scores</span></h1>\r\n                                            <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[9px] md:text-xs\">Real-time event performance and evaluation data</p>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => {\r\n                                                if (submissions.length === 0) return;\r\n                                                const csv = [['Event', 'Student Name', 'Roll Number', 'Score', 'Submitted At'], ...submissions.map(s => [s.eventTitle, s.name, s.rollNumber, s.score, s.timestamp?.toDate ? s.timestamp.toDate().toLocaleString() : 'N/A'])].map(e => e.join(\",\")).join(\"\\n\");\r\n                                                const blob = new Blob([csv], { type: 'text/csv' });\r\n                                                const url = window.URL.createObjectURL(blob);\r\n                                                const a = document.createElement('a');\r\n                                                a.setAttribute('href', url);\r\n                                                a.setAttribute('download', 'techspark_quiz_results.csv');\r\n                                                a.click();\r\n                                            }}\r\n                                            className=\"w-full sm:w-auto px-6 py-3.5 bg-white border border-slate-200 text-slate-900 rounded-xl md:rounded-2xl font-black text-[10px] md:text-xs uppercase tracking-widest hover:bg-slate-50 transition-all flex items-center justify-center gap-2 shadow-sm\"\r\n                                        >\r\n                                            <Download className=\"w-4 h-4\" /> Export Results\r\n                                        </button>\r\n                                    </header>\r\n\r\n                                    {loadingSubmissions ? (\r\n                                        <div className=\"h-64 flex flex-col items-center justify-center gap-4\">\r\n                                            <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\r\n                                            <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Intercepting Incoming Packets...</p>\r\n                                        </div>\r\n                                    ) : (\r\n                                        <div className=\"grid grid-cols-1 gap-6\">\r\n                                            {submissions.length > 0 ? (\r\n                                                <div className=\"bg-white border border-slate-200 rounded-[2rem] md:rounded-[2.5rem] shadow-sm overflow-hidden\">\r\n                                                    <div className=\"overflow-x-auto\">\r\n                                                        <table className=\"w-full text-left min-w-[700px]\">\r\n                                                            <thead className=\"bg-[#fcfdfe] text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100\">\r\n                                                                <tr>\r\n                                                                    <th className=\"px-8 py-6\">Operation / Quiz</th>\r\n                                                                    <th className=\"px-8 py-6\">Agent Identity</th>\r\n                                                                    <th className=\"px-8 py-6\">Performance Metric</th>\r\n                                                                    <th className=\"px-8 py-6 text-right\">Submission Time</th>\r\n                                                                </tr>\r\n                                                            </thead>\r\n                                                            <tbody className=\"divide-y divide-slate-50\">\r\n                                                                {submissions.map((sub) => (\r\n                                                                    <tr key={sub.id} className=\"hover:bg-slate-50/50 transition-colors group\">\r\n                                                                        <td className=\"px-8 py-6\">\r\n                                                                            <p className=\"text-sm font-black text-slate-800 uppercase tracking-tight italic\">{sub.eventTitle || 'Untitled Quiz'}</p>\r\n                                                                            <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-tight\">{sub.eventId?.slice(0, 8)}</p>\r\n                                                                        </td>\r\n                                                                        <td className=\"px-8 py-6\">\r\n                                                                            <p className=\"font-black text-slate-700 uppercase italic text-sm\">{sub.name}</p>\r\n                                                                            <p className=\"text-[10px] font-bold text-blue-600 uppercase tabular-nums\">{sub.rollNumber}</p>\r\n                                                                        </td>\r\n                                                                        <td className=\"px-8 py-6\">\r\n                                                                            <div className=\"flex items-center gap-3\">\r\n                                                                                <div className=\"px-4 py-2 bg-blue-50 text-blue-600 rounded-xl font-black text-sm border border-blue-100 italic\">\r\n                                                                                    {sub.score || 0} PTS\r\n                                                                                </div>\r\n                                                                                <div className=\"w-24 h-2 bg-slate-100 rounded-full overflow-hidden\">\r\n                                                                                    <div\r\n                                                                                        className=\"h-full bg-blue-600\"\r\n                                                                                        style={{ width: `${Math.min((sub.score / 100) * 100, 100)}%` }}\r\n                                                                                    />\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                        </td>\r\n                                                                        <td className=\"px-8 py-6 text-right\">\r\n                                                                            <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">\r\n                                                                                {sub.timestamp?.toDate ? sub.timestamp.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : 'N/A'}\r\n                                                                            </p>\r\n                                                                            <p className=\"text-[9px] text-slate-300 font-bold uppercase tracking-widest\">\r\n                                                                                {sub.timestamp?.toDate ? sub.timestamp.toDate().toLocaleDateString() : 'LOGGED'}\r\n                                                                            </p>\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                ))}\r\n                                                            </tbody>\r\n                                                        </table>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ) : (\r\n                                                <div className=\"h-96 bg-white border border-slate-200 border-dashed rounded-[3rem] flex flex-col items-center justify-center gap-6 opacity-40\">\r\n                                                    <Activity className=\"w-16 h-16 text-slate-300\" />\r\n                                                    <div className=\"text-center\">\r\n                                                        <h3 className=\"text-xl font-black text-slate-900 uppercase italic\">Awaiting Submissions</h3>\r\n                                                        <p className=\"text-xs font-bold text-slate-400 uppercase tracking-[0.2em] mt-2\">No live data signals detected for your operations</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : currentView === 'reports' ? (\r\n                            <motion.div key=\"reports\" initial={{ opacity: 0, scale: 0.98 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.98 }}>\r\n                                <div className=\"space-y-8 text-left\">\r\n                                    <header>\r\n                                        <h1 className=\"text-3xl md:text-4xl font-black text-slate-900 tracking-tighter uppercase italic\">Mission <span className=\"text-blue-600\">Intelligence</span></h1>\r\n                                        <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[9px] md:text-xs\">Strategic impact and participation analytics</p>\r\n                                    </header>\r\n\r\n                                    <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8\">\r\n                                        {[\r\n                                            { title: 'Demographics', desc: 'Department and Year-wise breakdown of participants.', icon: <Users className=\"w-6 h-6\" /> },\r\n                                            { title: 'Engagement', desc: 'Operation popularity and registration velocity trends.', icon: <TrendingUp className=\"w-6 h-6\" /> },\r\n                                            { title: 'Audit', desc: 'Complete mission logs and coordinator activity.', icon: <ClipboardList className=\"w-6 h-6\" /> }\r\n                                        ].map((rep, i) => (\r\n                                            <div key={i} className=\"bg-white p-8 md:p-10 rounded-[2rem] md:rounded-[2.5rem] border border-slate-200 shadow-sm hover:shadow-xl transition-all group\">\r\n                                                <div className=\"w-14 h-14 md:w-16 md:h-16 bg-slate-50 text-slate-400 rounded-2xl flex items-center justify-center mb-6 md:mb-8 group-hover:bg-blue-600 group-hover:text-white transition-all shadow-inner\">{rep.icon}</div>\r\n                                                <h4 className=\"text-lg md:text-xl font-black text-slate-800 uppercase italic mb-2\">{rep.title}</h4>\r\n                                                <p className=\"text-[10px] md:text-xs text-slate-400 font-bold uppercase leading-relaxed mb-6 md:mb-8\">{rep.desc}</p>\r\n                                                <button onClick={() => alert(\"Report generation sequence initiated. High-fidelity PDF will be ready in 10s.\")} className=\"w-full py-4 bg-slate-900 text-white rounded-xl md:rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-black transition-all\">Generate PDF Intel</button>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : currentView === 'profile' ? (\r\n                            <motion.div key=\"profile\" initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }}>\r\n                                <div className=\"max-w-2xl mx-auto space-y-8 text-left\">\r\n                                    <header>\r\n                                        <h1 className=\"text-3xl md:text-4xl font-black text-slate-900 tracking-tighter uppercase italic\">Lead <span className=\"text-blue-600\">Identity</span></h1>\r\n                                        <p className=\"text-slate-400 font-bold uppercase tracking-widest text-[10px] md:text-xs\">Credential and persona management terminal</p>\r\n                                    </header>\r\n\r\n                                    <div className=\"bg-white border border-slate-200 rounded-[2rem] md:rounded-[2.5rem] p-6 md:p-10 shadow-sm space-y-8\">\r\n                                        <div className=\"flex flex-col sm:flex-row items-center gap-6 md:gap-8 pb-8 border-b border-slate-50 text-center sm:text-left\">\r\n                                            <div className=\"w-20 h-20 md:w-24 md:h-24 bg-slate-900 rounded-[1.5rem] md:rounded-[2rem] flex items-center justify-center text-2xl md:text-3xl font-black text-white italic shadow-2xl shrink-0\">\r\n                                                {organizer.username.charAt(0).toUpperCase()}\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 className=\"text-xl md:text-2xl font-black text-slate-900 uppercase italic mb-1\">{profileData.fullName}</h3>\r\n                                                <p className=\"text-[10px] text-blue-600 font-black uppercase tracking-[0.2em]\">{organizer.username} | {profileData.department}</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6\">\r\n                                            {[\r\n                                                { label: 'Full Identity', key: 'fullName', type: 'text' },\r\n                                                { label: 'Official Email', key: 'email', type: 'email' },\r\n                                                { label: 'Contact Trace', key: 'phone', type: 'tel' },\r\n                                                { label: 'Operational Dept', key: 'department', type: 'text' }\r\n                                            ].map(field => (\r\n                                                <div key={field.key} className=\"space-y-2\">\r\n                                                    <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1\">{field.label}</label>\r\n                                                    <input\r\n                                                        type={field.type}\r\n                                                        value={profileData[field.key]}\r\n                                                        onChange={(e) => setProfileData({ ...profileData, [field.key]: e.target.value })}\r\n                                                        className=\"w-full px-4 md:px-5 py-3 md:py-4 bg-slate-50 border border-slate-100 rounded-xl md:rounded-2xl outline-none font-bold text-slate-800 text-sm focus:ring-4 focus:ring-blue-500/5 transition-all\"\r\n                                                    />\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n\r\n                                        <div className=\"pt-4\">\r\n                                            <button\r\n                                                onClick={() => alert(\"Identity parameters successfully synchronized.\")}\r\n                                                className=\"w-full py-5 bg-blue-600 text-white rounded-[1.5rem] font-black text-xs uppercase tracking-widest shadow-xl shadow-blue-500/20 hover:scale-[1.02] transition-all\"\r\n                                            >Synchronize Profile Credentials</button>\r\n                                        </div>\r\n\r\n                                        <div className=\"p-6 bg-slate-50 rounded-[2rem] border border-slate-100 flex items-center justify-between\">\r\n                                            <div>\r\n                                                <p className=\"text-[10px] font-black text-slate-800 uppercase italic\">Authorization Password</p>\r\n                                                <p className=\"text-[9px] text-slate-400 font-medium uppercase tracking-widest mt-1\">Last rotated 14 cycles ago</p>\r\n                                            </div>\r\n                                            <button className=\"px-6 py-3 bg-white border border-slate-200 text-slate-900 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-900 hover:text-white transition-all\">Change Passkey</button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : currentView === 'create' ? (\r\n                            <motion.div\r\n                                initial={{ opacity: 0, x: 20 }}\r\n                                animate={{ opacity: 1, x: 0 }}\r\n                                exit={{ opacity: 0, x: -20 }}\r\n                                className=\"max-w-4xl mx-auto\"\r\n                            >\r\n                                <div className=\"mb-12 text-left\">\r\n                                    <button\r\n                                        onClick={() => resetFormAndGoBack()}\r\n                                        className=\"flex items-center gap-2 text-slate-400 font-bold uppercase tracking-widest text-xs hover:text-slate-900 transition-colors mb-4\"\r\n                                    >\r\n                                        <ChevronLeft className=\"w-4 h-4\" /> {editingEventId ? 'CANCEL EDITING' : 'REVERT TO DASHBOARD'}\r\n                                    </button>\r\n                                    <h1 className=\"text-4xl font-black text-slate-900 tracking-tighter uppercase italic\">\r\n                                        {editingEventId ? 'Modify' : 'Strategic Event'} <span className=\"text-blue-600\">{editingEventId ? 'Event' : 'Creation'}</span>\r\n                                    </h1>\r\n                                    <p className=\"text-slate-400 font-bold text-[10px] md:text-xs uppercase tracking-[0.2em] mt-2\">\r\n                                        {editingEventId ? 'Update event details and resubmit for approval' : 'Authorization Workflow Protocol v2.4'}\r\n                                    </p>\r\n                                </div>\r\n\r\n                                {renderStepIndicator()}\r\n\r\n                                <div className=\"bg-white border border-slate-200 rounded-[2rem] md:rounded-[3rem] shadow-2xl p-6 md:p-12 text-left relative overflow-hidden\">\r\n                                    {/* Step 1: Basic Details */}\r\n                                    {activeStep === 1 && (\r\n                                        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\r\n                                            <div className=\"flex items-center gap-4 p-6 bg-blue-50 rounded-3xl border border-blue-100\">\r\n                                                <div className=\"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                                                    <Info className=\"w-6 h-6 text-white\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"text-sm font-black text-blue-900 uppercase\">Core Identification</h4>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"space-y-6\">\r\n                                                <div className=\"space-y-2\">\r\n                                                    <label className=\"block text-xs font-black text-slate-400 uppercase tracking-widest ml-1\">Event Title *</label>\r\n                                                    <input\r\n                                                        type=\"text\"\r\n                                                        placeholder=\"e.g. QUANTUM COMPUTING HACKATHON\"\r\n                                                        value={formData.title}\r\n                                                        onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                                                        className=\"w-full px-6 py-5 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/5 outline-none font-black text-slate-800 uppercase italic transition-all\"\r\n                                                    />\r\n                                                </div>\r\n\r\n                                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <label className=\"block text-xs font-black text-slate-400 uppercase tracking-widest ml-1\">Event Type *</label>\r\n                                                        <select\r\n                                                            value={formData.type}\r\n                                                            onChange={(e) => setFormData({ ...formData, type: e.target.value })}\r\n                                                            className=\"w-full px-5 md:px-6 py-4 md:py-5 bg-slate-50 border border-slate-200 rounded-xl md:rounded-2xl focus:ring-4 focus:ring-blue-500/5 outline-none font-black text-slate-800 transition-all uppercase text-sm\"\r\n                                                        >\r\n                                                            <option>Workshop</option>\r\n                                                            <option>Seminar</option>\r\n                                                            <option>Hackathon</option>\r\n                                                            <option>Quiz</option>\r\n                                                            <option>Webinar</option>\r\n                                                            <option>Expo</option>\r\n                                                        </select>\r\n                                                    </div>\r\n                                                    <div className=\"space-y-2\">\r\n                                                        <label className=\"block text-xs font-black text-slate-400 uppercase tracking-widest ml-1\">Operation Poster (URL)</label>\r\n                                                        <div className=\"relative\">\r\n                                                            <input\r\n                                                                type=\"text\"\r\n                                                                placeholder=\"IMAGE_ASSET_LINK\"\r\n                                                                value={formData.posterUrl}\r\n                                                                onChange={(e) => setFormData({ ...formData, posterUrl: e.target.value })}\r\n                                                                className=\"w-full px-5 md:px-6 py-4 md:py-5 bg-slate-50 border border-slate-200 rounded-xl md:rounded-2xl focus:ring-4 focus:ring-blue-500/5 outline-none font-black text-slate-800 transition-all text-sm\"\r\n                                                            />\r\n                                                            <Upload className=\"absolute right-6 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-300\" />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-2\">\r\n                                                    <label className=\"block text-xs font-black text-slate-400 uppercase tracking-widest ml-1\">Mission Briefing (Short Abstract) *</label>\r\n                                                    <textarea\r\n                                                        rows=\"2\"\r\n                                                        placeholder=\"1-2 lines summarizing the event scope...\"\r\n                                                        value={formData.shortDescription}\r\n                                                        onChange={(e) => setFormData({ ...formData, shortDescription: e.target.value })}\r\n                                                        className=\"w-full px-6 py-5 bg-slate-50 border border-slate-200 rounded-2xl focus:ring-4 focus:ring-blue-500/5 outline-none font-bold text-slate-800 transition-all resize-none\"\r\n                                                    />\r\n                                                </div>\r\n\r\n                                                <div className=\"space-y-2\">\r\n                                                    <label className=\"block text-xs font-black text-slate-400 uppercase tracking-widest ml-1\">Detailed Operational Scope *</label>\r\n                                                    <textarea\r\n                                                        rows=\"5\"\r\n                                                        placeholder=\"Describe modules, learning paths, and technical depth...\"\r\n                                                        value={formData.detailedDescription}\r\n                                                        onChange={(e) => setFormData({ ...formData, detailedDescription: e.target.value })}\r\n                                                        className=\"w-full px-6 py-5 bg-slate-50 border border-slate-200 rounded-[2rem] focus:ring-4 focus:ring-blue-500/5 outline-none font-medium text-slate-800 transition-all\"\r\n                                                    />\r\n                                                </div>\r\n\r\n                                                {/* Hackathon Specific: Problem Statements */}\r\n                                                {formData.type === 'Hackathon' && (\r\n                                                    <motion.div\r\n                                                        initial={{ opacity: 0, height: 0 }}\r\n                                                        animate={{ opacity: 1, height: 'auto' }}\r\n                                                        className=\"pt-6 border-t border-slate-100 space-y-6\"\r\n                                                    >\r\n                                                        <div className=\"flex items-center justify-between\">\r\n                                                            <div>\r\n                                                                <h4 className=\"text-sm font-black text-slate-900 uppercase italic\">Problem Statement Repository</h4>\r\n                                                                <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-widest\">Define challenges or enable open innovation</p>\r\n                                                            </div>\r\n                                                            <div className=\"flex items-center gap-3 bg-slate-50 px-4 py-2 rounded-xl border border-slate-200\">\r\n                                                                <input\r\n                                                                    type=\"checkbox\"\r\n                                                                    id=\"allowOpenStatement\"\r\n                                                                    checked={formData.allowOpenStatement}\r\n                                                                    onChange={(e) => setFormData({ ...formData, allowOpenStatement: e.target.checked })}\r\n                                                                    className=\"w-4 h-4 rounded accent-blue-600\"\r\n                                                                />\r\n                                                                <label htmlFor=\"allowOpenStatement\" className=\"text-[10px] font-black text-slate-600 uppercase tracking-tight cursor-pointer\">Allow Open Innovation (Custom Statements)</label>\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"space-y-4\">\r\n                                                            {(formData.problemStatements || []).map((ps, idx) => (\r\n                                                                <div key={idx} className=\"flex gap-2\">\r\n                                                                    <div className=\"flex-1 flex items-center gap-4 bg-slate-50 border border-slate-200 px-6 py-4 rounded-2xl\">\r\n                                                                        <span className=\"text-xs font-black text-blue-600\">#{idx + 1}</span>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            value={ps}\r\n                                                                            onChange={(e) => {\r\n                                                                                const newPS = [...formData.problemStatements];\r\n                                                                                newPS[idx] = e.target.value;\r\n                                                                                setFormData({ ...formData, problemStatements: newPS });\r\n                                                                            }}\r\n                                                                            placeholder=\"Define a specific challenge...\"\r\n                                                                            className=\"flex-1 bg-transparent border-none outline-none font-bold text-slate-700 text-sm\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <button\r\n                                                                        onClick={() => {\r\n                                                                            const newPS = formData.problemStatements.filter((_, i) => i !== idx);\r\n                                                                            setFormData({ ...formData, problemStatements: newPS });\r\n                                                                        }}\r\n                                                                        className=\"p-4 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-2xl transition-all\"\r\n                                                                    >\r\n                                                                        <X className=\"w-5 h-5\" />\r\n                                                                    </button>\r\n                                                                </div>\r\n                                                            ))}\r\n                                                            <button\r\n                                                                onClick={() => setFormData({ ...formData, problemStatements: [...(formData.problemStatements || []), ''] })}\r\n                                                                className=\"w-full py-4 border-2 border-dashed border-slate-200 rounded-2xl text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50/50 transition-all flex items-center justify-center gap-2\"\r\n                                                            >\r\n                                                                <Plus className=\"w-4 h-4\" /> Add Problem Statement\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </motion.div>\r\n                                                )}\r\n\r\n                                                {/* Quiz Specific: Google Form Integration */}\r\n                                                {formData.type === 'Quiz' && (\r\n                                                    <motion.div\r\n                                                        initial={{ opacity: 0, height: 0 }}\r\n                                                        animate={{ opacity: 1, height: 'auto' }}\r\n                                                        className=\"pt-6 border-t border-slate-100 space-y-6\"\r\n                                                    >\r\n                                                        <div className=\"flex items-center gap-4 p-5 bg-purple-50 rounded-2xl border border-purple-100\">\r\n                                                            <div className=\"w-10 h-10 bg-purple-600 rounded-xl flex items-center justify-center\">\r\n                                                                <FileText className=\"w-5 h-5 text-white\" />\r\n                                                            </div>\r\n                                                            <div>\r\n                                                                <h4 className=\"text-sm font-black text-purple-900 uppercase italic\">Quiz Integration Setup</h4>\r\n                                                                <p className=\"text-[10px] text-purple-500 font-bold\">Connect your Google Form for automated student verification</p>\r\n                                                            </div>\r\n                                                        </div>\r\n\r\n                                                        <div className=\"space-y-4\">\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Google Form URL *</label>\r\n                                                                <div className=\"relative\">\r\n                                                                    <input\r\n                                                                        type=\"text\"\r\n                                                                        placeholder=\"https://docs.google.com/forms/d/e/...\"\r\n                                                                        value={formData.quizFormUrl}\r\n                                                                        onChange={(e) => {\r\n                                                                            const url = e.target.value;\r\n                                                                            let updatedData = { ...formData, quizFormUrl: url };\r\n\r\n                                                                            // Magic Extraction Logic\r\n                                                                            if (url.includes('entry.')) {\r\n                                                                                try {\r\n                                                                                    const urlObj = new URL(url);\r\n                                                                                    const searchParams = new URLSearchParams(urlObj.search);\r\n                                                                                    let extractedAny = false;\r\n\r\n                                                                                    // Create a map of values to look for\r\n                                                                                    const mappings = {\r\n                                                                                        quizEntryName: ['name', 'student', 'test', 'full'],\r\n                                                                                        quizEntryRoll: ['roll', 'reg', '123', 'number', 'id'],\r\n                                                                                        quizEntryDept: ['dept', 'branch', 'cse', 'it', 'department'],\r\n                                                                                        quizEntryYear: ['year', '1st', '2nd', '3rd', '4th'],\r\n                                                                                        quizEntrySection: ['sec', 'section', 'a', 'b', 'c'],\r\n                                                                                        quizEntryMobile: ['phone', 'mobile', 'contact', '987']\r\n                                                                                    };\r\n\r\n                                                                                    searchParams.forEach((value, key) => {\r\n                                                                                        if (key.startsWith('entry.')) {\r\n                                                                                            extractedAny = true;\r\n                                                                                            const lowerVal = value.toLowerCase();\r\n\r\n                                                                                            // Try to find which field this belongs to\r\n                                                                                            for (const [field, keywords] of Object.entries(mappings)) {\r\n                                                                                                if (keywords.some(k => k.length <= 1 ? lowerVal === k : lowerVal.includes(k))) {\r\n                                                                                                    updatedData[field] = key;\r\n                                                                                                    break;\r\n                                                                                                }\r\n                                                                                            }\r\n                                                                                        }\r\n                                                                                    });\r\n\r\n                                                                                    if (extractedAny) {\r\n                                                                                        // Set the base URL (strip params)\r\n                                                                                        updatedData.quizFormUrl = url.split('?')[0];\r\n                                                                                        alert(\"Γ£¿ Magic Extraction Successful! I've automatically identified and mapped your Form Entry IDs. Please verify them below.\");\r\n                                                                                    }\r\n                                                                                } catch {\r\n                                                                                    console.log(\"Extraction failed, proceeding with literal URL\");\r\n                                                                                }\r\n                                                                            }\r\n\r\n                                                                            setFormData(updatedData);\r\n                                                                        }}\r\n                                                                        className=\"w-full px-5 py-4 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-sm text-slate-800 pr-12\"\r\n                                                                    />\r\n                                                                    {(formData.quizFormUrl || '').includes('docs.google.com') && (\r\n                                                                        <div className=\"absolute right-4 top-1/2 -translate-y-1/2\">\r\n                                                                            <Zap className=\"w-5 h-5 text-amber-500 animate-pulse\" />\r\n                                                                        </div>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                            </div>\r\n\r\n                                                            <div className=\"p-5 bg-slate-900 rounded-2xl space-y-4\">\r\n                                                                <p className=\"text-[10px] font-black text-blue-400 uppercase tracking-widest\">Pre-fill Entry IDs (from Google Form's \"Get pre-filled link\")</p>\r\n                                                                <div className=\"grid grid-cols-2 gap-4\">\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Name Field Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.123456789\"\r\n                                                                            value={formData.quizEntryName}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntryName: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Roll Number Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.987654321\"\r\n                                                                            value={formData.quizEntryRoll}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntryRoll: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Department Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.111222333\"\r\n                                                                            value={formData.quizEntryDept}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntryDept: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Year Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.444555666\"\r\n                                                                            value={formData.quizEntryYear}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntryYear: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Section Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.777888999\"\r\n                                                                            value={formData.quizEntrySection}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntrySection: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                    <div className=\"space-y-1\">\r\n                                                                        <label className=\"text-[9px] font-bold text-slate-500 uppercase\">Mobile Entry ID</label>\r\n                                                                        <input\r\n                                                                            type=\"text\"\r\n                                                                            placeholder=\"entry.000111222\"\r\n                                                                            value={formData.quizEntryMobile}\r\n                                                                            onChange={(e) => setFormData({ ...formData, quizEntryMobile: e.target.value })}\r\n                                                                            className=\"w-full px-4 py-3 bg-white/10 border border-white/10 rounded-lg outline-none font-mono text-xs text-white placeholder:text-slate-600\"\r\n                                                                        />\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <p className=\"text-[9px] text-slate-500 font-medium italic\">≡ƒÆí Get these IDs from Google Form ΓåÆ Γï« Menu ΓåÆ \"Get pre-filled link\" ΓåÆ Fill dummy values ΓåÆ Copy link & extract entry.XXXXX IDs</p>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </motion.div>\r\n                                                )}\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n\r\n                                    {/* Step 2: Date & Venue */}\r\n                                    {activeStep === 2 && (\r\n                                        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\r\n                                            <div className=\"flex items-center gap-4 p-6 bg-indigo-50 rounded-3xl border border-indigo-100\">\r\n                                                <div className=\"w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/20\">\r\n                                                    <MapPin className=\"w-6 h-6 text-white\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"text-sm font-black text-indigo-900 uppercase\">Spatiotemporal Logistics</h4>\r\n                                                    <p className=\"text-xs text-indigo-600 font-medium\">Configuring mission timeline and base location</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"grid grid-cols-2 gap-8\">\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2 font-black italic\">\r\n                                                            <Clock className=\"w-4 h-4\" /> Start Phase\r\n                                                        </h5>\r\n                                                        <div className=\"space-y-6\">\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Date</label>\r\n                                                                <input type=\"date\" value={formData.startDate} onChange={(e) => setFormData({ ...formData, startDate: e.target.value })} className=\"w-full px-5 py-4 bg-white border border-slate-200 rounded-xl font-black text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Time</label>\r\n                                                                <input type=\"time\" value={formData.startTime} onChange={(e) => setFormData({ ...formData, startTime: e.target.value })} className=\"w-full px-5 py-4 bg-white border border-slate-200 rounded-xl font-black text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2 font-black italic\">\r\n                                                            <Clock className=\"w-4 h-4\" /> Termination Phase\r\n                                                        </h5>\r\n                                                        <div className=\"space-y-6\">\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Date</label>\r\n                                                                <input type=\"date\" value={formData.endDate} onChange={(e) => setFormData({ ...formData, endDate: e.target.value })} className=\"w-full px-5 py-4 bg-white border border-slate-200 rounded-xl font-black text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Time</label>\r\n                                                                <input type=\"time\" value={formData.endTime} onChange={(e) => setFormData({ ...formData, endTime: e.target.value })} className=\"w-full px-5 py-4 bg-white border border-slate-200 rounded-xl font-black text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"space-y-6\">\r\n                                                <div className=\"flex items-center gap-8 p-8 bg-slate-900 rounded-[2.5rem] shadow-xl\">\r\n                                                    <div className=\"flex flex-col gap-4\">\r\n                                                        <label className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Base Type</label>\r\n                                                        <div className=\"flex gap-4\">\r\n                                                            {['Offline', 'Online', 'Hybrid'].map((v) => (\r\n                                                                <button\r\n                                                                    key={v}\r\n                                                                    type=\"button\"\r\n                                                                    onClick={() => setFormData({ ...formData, venueType: v })}\r\n                                                                    className={`px-6 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest transition-all ${formData.venueType === v ? 'bg-blue-600 text-white' : 'bg-white/5 text-slate-400 hover:bg-white/10'\r\n                                                                        }`}\r\n                                                                >\r\n                                                                    {v}\r\n                                                                </button>\r\n                                                            ))}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"flex-1 space-y-2\">\r\n                                                        <label className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Venue Designation / Platform Link</label>\r\n                                                        <input\r\n                                                            type=\"text\"\r\n                                                            placeholder={formData.venueType === 'Online' ? \"ZOOM / MEET LINK\" : \"BLOCK-B, LAB 402\"}\r\n                                                            value={formData.venueName}\r\n                                                            onChange={(e) => setFormData({ ...formData, venueName: e.target.value })}\r\n                                                            className=\"w-full px-6 py-4 bg-white/5 border border-white/10 rounded-2xl outline-none font-black text-sm text-white placeholder:text-slate-700\"\r\n                                                        />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n\r\n                                    {/* Step 3: Audience & Registration */}\r\n                                    {activeStep === 3 && (\r\n                                        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\r\n                                            <div className=\"flex items-center gap-4 p-6 bg-emerald-50 rounded-3xl border border-emerald-100\">\r\n                                                <div className=\"w-12 h-12 bg-emerald-600 rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-500/20\">\r\n                                                    <Users className=\"w-6 h-6 text-white\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"text-sm font-black text-emerald-900 uppercase\">Target Audience Protocol</h4>\r\n                                                    <p className=\"text-xs text-emerald-600 font-medium\">Calibrating accessibility and capacity metrics</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"grid grid-cols-2 gap-8\">\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6\">Eligibility Scope</h5>\r\n                                                        <div className=\"space-y-4\">\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Audience Class</label>\r\n                                                                <select\r\n                                                                    value={formData.audienceType}\r\n                                                                    onChange={(e) => setFormData({ ...formData, audienceType: e.target.value })}\r\n                                                                    className=\"w-full px-5 py-4 bg-white border border-slate-200 rounded-xl font-black text-sm text-slate-800 outline-none\"\r\n                                                                >\r\n                                                                    <option>Whole College</option>\r\n                                                                    <option>Department Wise</option>\r\n                                                                    <option>Year Wise</option>\r\n                                                                    <option>Section Wise</option>\r\n                                                                    <option>Custom</option>\r\n                                                                </select>\r\n                                                            </div>\r\n                                                            {formData.audienceType === 'Department Wise' && (\r\n                                                                <div className=\"space-y-3\">\r\n                                                                    <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Select Departments</label>\r\n                                                                    <div className=\"flex flex-wrap gap-2\">\r\n                                                                        {globalDemographics.departments.map(dept => (\r\n                                                                            <button\r\n                                                                                key={dept}\r\n                                                                                type=\"button\"\r\n                                                                                onClick={() => {\r\n                                                                                    const depts = formData.departments.includes(dept)\r\n                                                                                        ? formData.departments.filter(d => d !== dept)\r\n                                                                                        : [...formData.departments, dept];\r\n                                                                                    setFormData({ ...formData, departments: depts });\r\n                                                                                }}\r\n                                                                                className={`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${formData.departments.includes(dept) ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/20' : 'bg-white border border-slate-200 text-slate-500 hover:bg-slate-50'\r\n                                                                                    }`}\r\n                                                                            >\r\n                                                                                {dept}\r\n                                                                            </button>\r\n                                                                        ))}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )}\r\n\r\n                                                            {formData.audienceType === 'Year Wise' && (\r\n                                                                <div className=\"space-y-3\">\r\n                                                                    <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Target Years</label>\r\n                                                                    <div className=\"flex gap-3 flex-wrap\">\r\n                                                                        {globalDemographics.years.map(year => (\r\n                                                                            <button\r\n                                                                                key={year}\r\n                                                                                type=\"button\"\r\n                                                                                onClick={() => {\r\n                                                                                    const years = formData.years.includes(year)\r\n                                                                                        ? formData.years.filter(y => y !== year)\r\n                                                                                        : [...formData.years, year];\r\n                                                                                    setFormData({ ...formData, years: years });\r\n                                                                                }}\r\n                                                                                className={`w-12 h-12 rounded-xl text-xs font-black transition-all ${formData.years.includes(year) ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/20' : 'bg-white border border-slate-200 text-slate-500 hover:bg-slate-50'\r\n                                                                                    }`}\r\n                                                                            >\r\n                                                                                {year}\r\n                                                                            </button>\r\n                                                                        ))}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )}\r\n\r\n                                                            {(formData.audienceType === 'Section Wise' || formData.audienceType === 'Custom') && (\r\n                                                                <div className=\"space-y-4\">\r\n                                                                    <div className=\"grid grid-cols-2 gap-3\">\r\n                                                                        <select\r\n                                                                            value={formData.departments[0] || \"\"}\r\n                                                                            onChange={(e) => setFormData({ ...formData, departments: e.target.value ? [e.target.value] : [] })}\r\n                                                                            className=\"px-4 py-2 bg-white border border-slate-200 rounded-lg text-[10px] font-black uppercase outline-none focus:border-blue-500 transition-colors\"\r\n                                                                        >\r\n                                                                            <option value=\"\">SELECT DEPT</option>\r\n                                                                            {globalDemographics.departments.map(dept => (\r\n                                                                                <option key={dept} value={dept}>{dept}</option>\r\n                                                                            ))}\r\n                                                                        </select>\r\n                                                                        <select\r\n                                                                            value={formData.years[0] || \"\"}\r\n                                                                            onChange={(e) => setFormData({ ...formData, years: e.target.value ? [e.target.value] : [] })}\r\n                                                                            className=\"px-4 py-2 bg-white border border-slate-200 rounded-lg text-[10px] font-black uppercase outline-none focus:border-blue-500 transition-colors\"\r\n                                                                        >\r\n                                                                            <option value=\"\">SELECT YEAR</option>\r\n                                                                            {globalDemographics.years.map(year => (\r\n                                                                                <option key={year} value={year}>{year}</option>\r\n                                                                            ))}\r\n                                                                        </select>\r\n\r\n                                                                        {/* Flagged Only Toggle */}\r\n                                                                        <button\r\n                                                                            onClick={() => setShowFlaggedOnly(!showFlaggedOnly)}\r\n                                                                            className={`px-4 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all flex items-center gap-2 border ${showFlaggedOnly\r\n                                                                                ? 'bg-red-500 text-white border-red-500 shadow-lg shadow-red-500/20'\r\n                                                                                : 'bg-slate-50 text-slate-500 border-slate-200 hover:border-red-300 hover:text-red-500'\r\n                                                                                }`}\r\n                                                                        >\r\n                                                                            ≡ƒÜ⌐ {showFlaggedOnly ? 'SHOWING FLAGGED' : 'FLAGGED'}\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                    <div className=\"flex flex-wrap gap-2\">\r\n                                                                        {globalDemographics.sections.map(sec => (\r\n                                                                            <button\r\n                                                                                key={sec}\r\n                                                                                type=\"button\"\r\n                                                                                onClick={() => {\r\n                                                                                    const secs = formData.sections.includes(sec)\r\n                                                                                        ? formData.sections.filter(s => s !== sec)\r\n                                                                                        : [...formData.sections, sec];\r\n                                                                                    setFormData({ ...formData, sections: secs });\r\n                                                                                }}\r\n                                                                                className={`w-10 h-10 rounded-lg text-xs font-black transition-all ${formData.sections.includes(sec) ? 'bg-slate-900 text-white' : 'bg-white border border-slate-200 text-slate-500'\r\n                                                                                    }`}\r\n                                                                            >\r\n                                                                                {sec}\r\n                                                                            </button>\r\n                                                                        ))}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            )}\r\n\r\n                                                            <div className=\"p-4 bg-slate-900 rounded-2xl border border-white/5\">\r\n                                                                <p className=\"text-[9px] font-black text-blue-400 uppercase mb-2\">Target Eligibility Summary</p>\r\n                                                                <p className=\"text-[10px] font-bold text-slate-400 italic\">\r\n                                                                    {formData.audienceType === 'Whole College' ? 'OPEN ACCESS TO ALL STUDENTS' : (\r\n                                                                        `RESTRICTED TO: ${formData.departments.join(', ') || 'ALL'} ${formData.years.length ? `(YEAR ${formData.years.join(', ')})` : ''} ${formData.sections.length ? `[SEC ${formData.sections.join(', ')}]` : ''}`\r\n                                                                    )}\r\n                                                                </p>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-900 rounded-[2.5rem] shadow-xl text-white\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-6\">Capacity Terminal</h5>\r\n                                                        <div className=\"space-y-6\">\r\n                                                            <div className=\"flex items-center justify-between p-2 hover:bg-white/5 rounded-xl transition-all cursor-pointer group\" onClick={() => setFormData({ ...formData, registrationRequired: !formData.registrationRequired })}>\r\n                                                                <label className=\"text-[10px] font-black uppercase tracking-widest cursor-pointer group-hover:text-blue-400 transition-colors\">Entry Registration</label>\r\n                                                                <div\r\n                                                                    className={`w-12 h-6 rounded-full transition-all relative ${formData.registrationRequired ? 'bg-blue-600 shadow-lg shadow-blue-500/20' : 'bg-slate-700'}`}\r\n                                                                >\r\n                                                                    <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${formData.registrationRequired ? 'right-1' : 'left-1'}`} />\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div className=\"space-y-2\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Max Deployment Units (Participants)</label>\r\n                                                                <div className=\"relative\">\r\n                                                                    <input\r\n                                                                        type=\"number\"\r\n                                                                        placeholder=\"100\"\r\n                                                                        value={formData.maxParticipants}\r\n                                                                        onChange={(e) => setFormData({ ...formData, maxParticipants: e.target.value })}\r\n                                                                        className=\"w-full px-5 py-4 bg-white/5 border border-white/10 rounded-xl font-black text-sm text-white outline-none focus:border-blue-500/50 transition-all\"\r\n                                                                    />\r\n                                                                    <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex flex-col gap-0.5\">\r\n                                                                        <button\r\n                                                                            type=\"button\"\r\n                                                                            onClick={() => setFormData(prev => ({ ...prev, maxParticipants: (parseInt(prev.maxParticipants) || 0) + 10 }))}\r\n                                                                            className=\"p-1 hover:bg-white/10 rounded text-slate-500 hover:text-white transition-all\"\r\n                                                                        >\r\n                                                                            <ChevronUp className=\"w-3 h-3\" />\r\n                                                                        </button>\r\n                                                                        <button\r\n                                                                            type=\"button\"\r\n                                                                            onClick={() => setFormData(prev => ({ ...prev, maxParticipants: Math.max(0, (parseInt(prev.maxParticipants) || 0) - 10) }))}\r\n                                                                            className=\"p-1 hover:bg-white/10 rounded text-slate-500 hover:text-white transition-all\"\r\n                                                                        >\r\n                                                                            <ChevronDown className=\"w-3 h-3\" />\r\n                                                                        </button>\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div className=\"flex items-center justify-between p-2 hover:bg-white/5 rounded-xl transition-all cursor-pointer group\" onClick={() => setFormData({ ...formData, waitingList: !formData.waitingList })}>\r\n                                                                <label className=\"text-[10px] font-black uppercase tracking-widest cursor-pointer group-hover:text-indigo-400 transition-colors\">Enable Awaiting List</label>\r\n                                                                <div\r\n                                                                    className={`w-12 h-6 rounded-full transition-all relative ${formData.waitingList ? 'bg-indigo-600 shadow-lg shadow-indigo-500/20' : 'bg-slate-700'}`}\r\n                                                                >\r\n                                                                    <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${formData.waitingList ? 'right-1' : 'left-1'}`} />\r\n                                                                </div>\r\n                                                            </div>\r\n\r\n                                                            <div className=\"pt-4 mt-4 border-t border-white/10 space-y-6\">\r\n                                                                <div className=\"flex items-center justify-between p-2 hover:bg-white/5 rounded-xl transition-all cursor-pointer group\" onClick={() => setFormData({ ...formData, isTeamEvent: !formData.isTeamEvent })}>\r\n                                                                    <div>\r\n                                                                        <label className=\"text-[10px] font-black uppercase tracking-widest block text-blue-400 cursor-pointer group-hover:text-emerald-400 transition-colors\">Team Participation</label>\r\n                                                                        <p className=\"text-[9px] text-slate-500 font-medium\">Require students to register as teams</p>\r\n                                                                    </div>\r\n                                                                    <div\r\n                                                                        className={`w-12 h-6 rounded-full transition-all relative ${formData.isTeamEvent ? 'bg-emerald-600 shadow-lg shadow-emerald-500/20' : 'bg-slate-700'}`}\r\n                                                                    >\r\n                                                                        <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${formData.isTeamEvent ? 'right-1' : 'left-1'}`} />\r\n                                                                    </div>\r\n                                                                </div>\r\n\r\n                                                                {formData.isTeamEvent && (\r\n                                                                    <div className=\"grid grid-cols-2 gap-4 animate-fade-in\">\r\n                                                                        <div className=\"space-y-2\">\r\n                                                                            <label className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Min Team Size</label>\r\n                                                                            <input\r\n                                                                                type=\"number\"\r\n                                                                                value={formData.minTeamSize}\r\n                                                                                onChange={(e) => setFormData({ ...formData, minTeamSize: e.target.value })}\r\n                                                                                className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl font-black text-sm text-white outline-none\"\r\n                                                                            />\r\n                                                                        </div>\r\n                                                                        <div className=\"space-y-2\">\r\n                                                                            <label className=\"text-[9px] font-black text-slate-500 uppercase tracking-widest\">Max Team Size</label>\r\n                                                                            <input\r\n                                                                                type=\"number\"\r\n                                                                                value={formData.maxTeamSize}\r\n                                                                                onChange={(e) => setFormData({ ...formData, maxTeamSize: e.target.value })}\r\n                                                                                className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl font-black text-sm text-white outline-none\"\r\n                                                                            />\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n\r\n                                    {/* Step 4: Finalize */}\r\n                                    {activeStep === 4 && (\r\n                                        <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"space-y-8\">\r\n                                            <div className=\"flex items-center gap-4 p-6 bg-slate-900 rounded-3xl border border-slate-800 shadow-xl\">\r\n                                                <div className=\"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                                                    <Shield className=\"w-6 h-6 text-white\" />\r\n                                                </div>\r\n                                                <div>\r\n                                                    <h4 className=\"text-sm font-black text-white uppercase tracking-tight italic\">Authorization Transmission</h4>\r\n                                                    <p className=\"text-xs text-slate-500 font-medium uppercase tracking-widest\">FinalIZING Operation Control parameters</p>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"grid grid-cols-2 gap-8\">\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6\">Mission Coordinator</h5>\r\n                                                        <div className=\"space-y-4\">\r\n                                                            <div className=\"space-y-1\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Full Designation Name</label>\r\n                                                                <input type=\"text\" value={formData.coordinatorName} onChange={(e) => setFormData({ ...formData, coordinatorName: e.target.value })} className=\"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl font-bold text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                            <div className=\"space-y-1\">\r\n                                                                <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Communication Channel (Phone)</label>\r\n                                                                <input type=\"text\" value={formData.coordinatorPhone} onChange={(e) => setFormData({ ...formData, coordinatorPhone: e.target.value })} className=\"w-full px-4 py-3 bg-white border border-slate-200 rounded-xl font-bold text-sm text-slate-800 outline-none\" />\r\n                                                            </div>\r\n                                                            <div className=\"flex items-center gap-3 py-2\">\r\n                                                                <input type=\"checkbox\" checked={formData.displayCoordinator} onChange={(e) => setFormData({ ...formData, displayCoordinator: e.target.checked })} className=\"w-5 h-5 rounded-lg accent-blue-600\" />\r\n                                                                <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest\">Publically Project Identity</label>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"space-y-6\">\r\n                                                    <div className=\"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100 h-full flex flex-col\">\r\n                                                        <h5 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6\">Internal Intel</h5>\r\n                                                        <textarea\r\n                                                            rows=\"6\"\r\n                                                            placeholder=\"Private notes for Super Admin and internal tracking...\"\r\n                                                            value={formData.internalNotes}\r\n                                                            onChange={(e) => setFormData({ ...formData, internalNotes: e.target.value })}\r\n                                                            className=\"w-full flex-1 px-5 py-4 bg-white border border-slate-200 rounded-2xl outline-none font-medium text-slate-600 resize-none italic text-sm\"\r\n                                                        />\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"p-8 bg-blue-600 rounded-[2.5rem] text-white shadow-xl shadow-blue-500/20\">\r\n                                                <div className=\"flex items-start gap-4\">\r\n                                                    <input\r\n                                                        type=\"checkbox\"\r\n                                                        id=\"terms\"\r\n                                                        checked={formData.acceptedTerms}\r\n                                                        onChange={(e) => setFormData({ ...formData, acceptedTerms: e.target.checked })}\r\n                                                        className=\"mt-1 w-6 h-6 rounded-lg accent-white bg-transparent border-2 border-white/30\"\r\n                                                    />\r\n                                                    <div>\r\n                                                        <label htmlFor=\"terms\" className=\"text-sm font-black uppercase italic tracking-tighter\">I certify that this operation adheres to the club's technical standards and college policy.</label>\r\n                                                        <p className=\"text-[10px] text-white/60 font-medium mt-1\">Submission will lock specific fields until Authorization Review is complete.</p>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </motion.div>\r\n                                    )}\r\n\r\n                                    {/* Action Buttons */}\r\n                                    <div className=\"mt-12 flex items-center justify-between pt-8 border-t border-slate-100\">\r\n                                        <div className=\"flex gap-4\">\r\n                                            {activeStep === 1 ? (\r\n                                                <button\r\n                                                    onClick={() => { if (confirm(\"Discard all draft data?\")) setCurrentView('dashboard'); }}\r\n                                                    className=\"px-8 py-4 bg-slate-100 text-slate-500 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-red-50 hover:text-red-500 transition-all\"\r\n                                                >\r\n                                                    Discard\r\n                                                </button>\r\n                                            ) : (\r\n                                                <button\r\n                                                    onClick={() => setActiveStep(prev => prev - 1)}\r\n                                                    className=\"px-8 py-4 bg-slate-100 text-slate-500 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-slate-200 transition-all flex items-center gap-2\"\r\n                                                >\r\n                                                    <ChevronLeft className=\"w-4 h-4\" /> Previous Step\r\n                                                </button>\r\n                                            )}\r\n                                            <button\r\n                                                onClick={() => handleCreateEvent('DRAFT')}\r\n                                                className=\"px-8 py-4 bg-white border border-slate-200 text-slate-600 rounded-2xl font-black text-xs uppercase tracking-widest hover:shadow-lg transition-all flex items-center gap-2\"\r\n                                            >\r\n                                                <Save className=\"w-4 h-4\" /> Save as Draft\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex gap-4\">\r\n                                            <button className=\"px-8 py-4 bg-slate-50 text-slate-500 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-white border border-slate-200 transition-all flex items-center gap-2\">\r\n                                                <Eye className=\"w-4 h-4 text-blue-500\" /> Preview\r\n                                            </button>\r\n                                            {activeStep < 4 ? (\r\n                                                <button\r\n                                                    onClick={() => setActiveStep(prev => prev + 1)}\r\n                                                    className=\"px-10 py-4 bg-blue-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-xl shadow-blue-500/20 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center gap-2\"\r\n                                                >\r\n                                                    Progress Next <ChevronRight className=\"w-4 h-4\" />\r\n                                                </button>\r\n                                            ) : (\r\n                                                <button\r\n                                                    onClick={() => handleCreateEvent('PENDING')}\r\n                                                    disabled={isSubmitting}\r\n                                                    className=\"px-10 py-4 bg-slate-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-2xl shadow-slate-900/20 hover:scale-[1.05] active:scale-[0.95] transition-all flex items-center gap-2 disabled:bg-slate-400\"\r\n                                                >\r\n                                                    {isSubmitting ? 'TRANSMITTING...' : 'SUBMIT FOR APPROVAL'} <Send className=\"w-4 h-4\" />\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"mt-8 flex items-center justify-center gap-8 opacity-40\">\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"w-2 h-2 rounded-full bg-slate-400\" />\r\n                                        <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">End-to-End Encryption</p>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <div className=\"w-2 h-2 rounded-full bg-slate-400\" />\r\n                                        <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Direct Admin Channel</p>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        ) : null}\r\n                    </AnimatePresence>\r\n                </div>\r\n            </main >\r\n\r\n            {/* Global Custom Scrollbar Style */}\r\n            < style > {`\r\n                .custom-scrollbar::-webkit-scrollbar {\r\n                    width: 6px;\r\n                }\r\n                .custom-scrollbar::-webkit-scrollbar-track {\r\n                    background: transparent;\r\n                }\r\n                .custom-scrollbar::-webkit-scrollbar-thumb {\r\n                    background: #e2e8f0;\r\n                    border-radius: 10px;\r\n                }\r\n                .custom-scrollbar::-webkit-scrollbar-thumb:hover {\r\n                    background: #cbd5e1;\r\n                }\r\n            `}</style >\r\n\r\n            {/* Feedback Visualization Modal */}\r\n            < AnimatePresence >\r\n                {showFeedbackModal && (\r\n                    <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4\">\r\n                        <motion.div\r\n                            initial={{ opacity: 0 }}\r\n                            animate={{ opacity: 1 }}\r\n                            exit={{ opacity: 0 }}\r\n                            onClick={() => setShowFeedbackModal(false)}\r\n                            className=\"absolute inset-0 bg-slate-900/40 backdrop-blur-sm\"\r\n                        />\r\n                        <motion.div\r\n                            initial={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                            animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                            exit={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                            className=\"bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl relative overflow-hidden flex flex-col max-h-[85vh] z-10\"\r\n                        >\r\n                            {/* Header */}\r\n                            <div className=\"p-8 bg-slate-900 text-white text-left relative shrink-0\">\r\n                                <button\r\n                                    onClick={() => setShowFeedbackModal(false)}\r\n                                    className=\"absolute top-6 right-6 p-2 hover:bg-white/10 rounded-xl transition-colors\"\r\n                                >\r\n                                    <X className=\"w-5 h-5 text-slate-400\" />\r\n                                </button>\r\n                                <div className=\"flex items-center gap-4\">\r\n                                    <div className=\"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/20\">\r\n                                        <Activity className=\"w-6 h-6\" />\r\n                                    </div>\r\n                                    <div className=\"flex-1\">\r\n                                        <div className=\"flex items-center justify-between\">\r\n                                            <h3 className=\"text-2xl font-black uppercase italic tracking-tight\">Mission Intelligence</h3>\r\n                                            {selectedEventFeedback.length > 0 && (\r\n                                                <button\r\n                                                    onClick={handleDownloadFeedbackPDF}\r\n                                                    className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-[9px] font-black uppercase tracking-widest rounded-xl flex items-center gap-2 transition-all shadow-lg shadow-blue-500/20\"\r\n                                                >\r\n                                                    <Download className=\"w-3.5 h-3.5\" /> Download Report\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                        <p className=\"text-slate-400 text-[10px] font-bold uppercase tracking-widest mt-1\">Real-time feedback & Strategic Insights</p>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex-1 overflow-y-auto p-8 pt-0 custom-scrollbar\">\r\n                                {loadingFeedback ? (\r\n                                    <div className=\"py-20 flex flex-col items-center gap-4 opacity-50\">\r\n                                        <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\r\n                                        <p className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500\">Decrypting Response Cloud...</p>\r\n                                    </div>\r\n                                ) : selectedEventFeedback.length === 0 ? (\r\n                                    <div className=\"py-20 flex flex-col items-center gap-4 opacity-30\">\r\n                                        <Zap className=\"w-12 h-12 text-slate-400\" />\r\n                                        <p className=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500\">No tactical feedback received yet</p>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className=\"space-y-6 pt-8\">\r\n                                        {/* Stats Summary */}\r\n                                        <div className=\"grid grid-cols-2 gap-4 mb-8\">\r\n                                            <div className=\"p-6 bg-slate-50 rounded-3xl border border-slate-100\">\r\n                                                <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-2\">Avg. Performance</p>\r\n                                                <div className=\"flex items-end gap-2\">\r\n                                                    <h4 className=\"text-3xl font-black italic text-slate-900\">\r\n                                                        {(selectedEventFeedback.reduce((acc, curr) => acc + curr.rating, 0) / selectedEventFeedback.length).toFixed(1)}\r\n                                                    </h4>\r\n                                                    <span className=\"text-xs font-bold text-blue-600 mb-1\">/ 5.0</span>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"p-6 bg-slate-50 rounded-3xl border border-slate-100\">\r\n                                                <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-2\">Response Volume</p>\r\n                                                <h4 className=\"text-3xl font-black italic text-slate-900\">{selectedEventFeedback.length}</h4>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"space-y-4\">\r\n                                            {selectedEventFeedback.map((item, idx) => (\r\n                                                <motion.div\r\n                                                    key={item.id}\r\n                                                    initial={{ opacity: 0, x: -10 }}\r\n                                                    animate={{ opacity: 1, x: 0 }}\r\n                                                    transition={{ delay: idx * 0.05 }}\r\n                                                    className=\"p-6 rounded-3xl border border-slate-100 bg-white hover:border-blue-100 hover:shadow-xl hover:shadow-blue-500/5 transition-all text-left\"\r\n                                                >\r\n                                                    <div className=\"flex items-start justify-between mb-4\">\r\n                                                        <div>\r\n                                                            <h5 className=\"text-sm font-black text-slate-800 uppercase italic\">{item.studentName}</h5>\r\n                                                            <p className=\"text-[10px] text-blue-600 font-bold uppercase tracking-tight\">{item.studentRoll} ΓÇó {item.studentDept}</p>\r\n                                                        </div>\r\n                                                        <div className=\"flex gap-1\">\r\n                                                            {[...Array(5)].map((_, i) => (\r\n                                                                <Zap key={i} className={`w-3 h-3 ${i < item.rating ? 'text-blue-600 fill-current' : 'text-slate-100'}`} />\r\n                                                            ))}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"mb-4\">\r\n                                                        <span className=\"px-2 py-1 bg-slate-100 text-slate-500 text-[8px] font-black uppercase rounded-lg border border-slate-200\">\r\n                                                            {item.category}\r\n                                                        </span>\r\n                                                    </div>\r\n                                                    <p className=\"text-xs text-slate-600 font-medium leading-relaxed italic\">\r\n                                                        \"{item.comment || 'No detailed debrief provided.'}\"\r\n                                                    </p>\r\n                                                    <p className=\"text-[8px] text-slate-300 font-bold uppercase tracking-widest mt-4\">\r\n                                                        Captured: {item.submittedAt?.toDate?.() ? item.submittedAt.toDate().toLocaleString() : 'Just now'}\r\n                                                    </p>\r\n                                                </motion.div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                )}\r\n\r\n                {/* Export Configuration Modal */}\r\n                {\r\n                    isExportModalOpen && (\r\n                        <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-6\">\r\n                            <motion.div\r\n                                initial={{ opacity: 0 }}\r\n                                animate={{ opacity: 1 }}\r\n                                exit={{ opacity: 0 }}\r\n                                onClick={() => setIsExportModalOpen(false)}\r\n                                className=\"absolute inset-0 bg-slate-950/60 backdrop-blur-md\"\r\n                            />\r\n                            <motion.div\r\n                                initial={{ opacity: 0, scale: 0.95, y: 30 }}\r\n                                animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                                exit={{ opacity: 0, scale: 0.95, y: 30 }}\r\n                                className=\"relative w-full max-w-4xl bg-white rounded-[3rem] shadow-[0_32px_128px_-16px_rgba(0,0,0,0.3)] overflow-hidden flex flex-col max-h-[90vh]\"\r\n                            >\r\n                                {/* Premium Header */}\r\n                                <div className=\"p-10 bg-slate-900 text-white relative overflow-hidden shrink-0\">\r\n                                    <div className=\"absolute top-0 right-0 w-96 h-96 bg-blue-600/10 blur-[120px] -mr-48 -mt-48\" />\r\n                                    <div className=\"absolute bottom-0 left-0 w-64 h-64 bg-blue-600/5 blur-[80px] -ml-32 -mb-32\" />\r\n\r\n                                    <div className=\"flex items-center justify-between relative z-10\">\r\n                                        <div className=\"flex items-center gap-6\">\r\n                                            <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-700 rounded-2xl flex items-center justify-center shadow-2xl shadow-blue-500/20 ring-4 ring-blue-500/10\">\r\n                                                <Download className=\"w-8 h-8 text-white\" />\r\n                                            </div>\r\n                                            <div>\r\n                                                <h3 className=\"text-2xl font-black uppercase italic tracking-tight mb-1\">Export Matrix Configuration</h3>\r\n                                                <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-[0.3em]\">Operational Dimension Selection for {exportType} extraction</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        <button\r\n                                            onClick={() => setIsExportModalOpen(false)}\r\n                                            className=\"w-12 h-12 rounded-2xl bg-white/5 flex items-center justify-center hover:bg-white/10 transition-all border border-white/10 group\"\r\n                                        >\r\n                                            <X className=\"w-6 h-6 text-slate-400 group-hover:text-white transition-colors\" />\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Configuration Body */}\r\n                                <div className=\"p-10 space-y-10 overflow-y-auto custom-scrollbar\">\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-12\">\r\n                                        {['Identity', 'Academic', 'Contact', 'Team', 'Strategic', 'Timeline', 'Admin'].map(category => (\r\n                                            <div key={category} className=\"space-y-5\">\r\n                                                <div className=\"flex items-center justify-between border-b border-slate-100 pb-3\">\r\n                                                    <div className=\"flex items-center gap-3\">\r\n                                                        <div className=\"w-2 h-5 bg-blue-600 rounded-full\" />\r\n                                                        <h4 className=\"text-[11px] font-black text-slate-900 uppercase tracking-[0.2em]\">{category} Infrastructure</h4>\r\n                                                    </div>\r\n                                                    <span className=\"text-[9px] font-black text-slate-300 uppercase tracking-widest\">{availableFields.filter(f => f.category === category).length} Nodes</span>\r\n                                                </div>\r\n                                                <div className=\"space-y-3\">\r\n                                                    {availableFields.filter(f => f.category === category).map(field => (\r\n                                                        <label key={field.id} className=\"flex items-center gap-4 p-4 bg-slate-50/50 border border-slate-100 rounded-2xl cursor-pointer hover:border-blue-300 hover:bg-white hover:shadow-xl hover:shadow-blue-500/5 transition-all group relative overflow-hidden\">\r\n                                                            {selectedFields.includes(field.id) && (\r\n                                                                <motion.div layoutId={`bg-${field.id}`} className=\"absolute inset-0 bg-blue-50/50\" />\r\n                                                            )}\r\n                                                            <div className=\"relative z-10 flex items-center gap-4 w-full\">\r\n                                                                <div className=\"relative flex items-center justify-center\">\r\n                                                                    <input\r\n                                                                        type=\"checkbox\"\r\n                                                                        checked={selectedFields.includes(field.id)}\r\n                                                                        onChange={(e) => {\r\n                                                                            if (e.target.checked) setSelectedFields([...selectedFields, field.id]);\r\n                                                                            else setSelectedFields(selectedFields.filter(f => f !== field.id));\r\n                                                                        }}\r\n                                                                        className=\"w-6 h-6 rounded-lg border-2 border-slate-200 text-blue-600 focus:ring-blue-500/20 transition-all cursor-pointer accent-blue-600\"\r\n                                                                    />\r\n                                                                </div>\r\n                                                                <span className={`text-[11px] font-black uppercase tracking-wide transition-colors ${selectedFields.includes(field.id) ? 'text-blue-600' : 'text-slate-600 group-hover:text-blue-500'}`}>\r\n                                                                    {field.label}\r\n                                                                </span>\r\n                                                            </div>\r\n                                                        </label>\r\n                                                    ))}\r\n                                                </div>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n\r\n                                    {/* Summary & Actions */}\r\n                                    <div className=\"space-y-8 pt-6\">\r\n                                        <div className=\"flex items-center gap-6 p-6 bg-slate-900 rounded-[2rem] text-white shadow-2xl shadow-slate-900/20 relative overflow-hidden group\">\r\n                                            <div className=\"absolute top-0 right-0 w-32 h-32 bg-blue-500/10 blur-[40px] group-hover:bg-blue-500/20 transition-all\" />\r\n                                            <div className=\"flex-1 space-y-2\">\r\n                                                <p className=\"text-[10px] text-slate-400 font-bold uppercase tracking-[0.2em]\">Selection Intelligence</p>\r\n                                                <div className=\"flex items-center gap-4\">\r\n                                                    <button\r\n                                                        onClick={() => setSelectedFields(availableFields.map(f => f.id))}\r\n                                                        className=\"px-6 py-2.5 bg-white/10 hover:bg-white text-[10px] font-black text-white hover:text-slate-900 uppercase tracking-widest rounded-xl transition-all border border-white/10\"\r\n                                                    >\r\n                                                        Full Extraction\r\n                                                    </button>\r\n                                                    <button\r\n                                                        onClick={() => setSelectedFields(['name', 'roll'])}\r\n                                                        className=\"px-6 py-2.5 bg-white/5 hover:bg-white/10 text-[10px] font-black text-slate-400 hover:text-white uppercase tracking-widest rounded-xl transition-all border border-white/5\"\r\n                                                    >\r\n                                                        Core Essentials\r\n                                                    </button>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div className=\"text-right border-l border-white/10 pl-8\">\r\n                                                <h4 className=\"text-3xl font-black italic mb-1 text-blue-400\">{selectedFields.length}</h4>\r\n                                                <p className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest\">Dimensions Active</p>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex gap-6\">\r\n                                            <button\r\n                                                onClick={() => setIsExportModalOpen(false)}\r\n                                                className=\"flex-1 py-6 bg-slate-100 text-slate-600 rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] hover:bg-slate-200 transition-all border border-slate-200\"\r\n                                            >\r\n                                                Abort Extraction\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={() => {\r\n                                                    handleDownloadSubReport(selectedEvent, exportType);\r\n                                                    setIsExportModalOpen(false);\r\n                                                }}\r\n                                                disabled={selectedFields.length === 0}\r\n                                                className=\"flex-[2] py-6 bg-blue-600 text-white rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] shadow-[0_20px_40px_-12px_rgba(37,99,235,0.4)] hover:shadow-[0_25px_50px_-12px_rgba(37,99,235,0.6)] hover:bg-blue-700 transition-all flex items-center justify-center gap-4 disabled:opacity-40 disabled:shadow-none\"\r\n                                            >\r\n                                                <ShieldCheck className=\"w-6 h-6 text-emerald-400\" />\r\n                                                <span>Generate Official Report</span>\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n                        </div>\r\n                    )}\r\n            </AnimatePresence>\r\n\r\n            {/* QR Scanner Modal for Finding Students */}\r\n            <AnimatePresence>\r\n                {isScannerOpen && (\r\n                    <div className=\"fixed inset-0 z-[150] flex items-center justify-center p-4\">\r\n                        <motion.div\r\n                            initial={{ opacity: 0 }}\r\n                            animate={{ opacity: 1 }}\r\n                            exit={{ opacity: 0 }}\r\n                            onClick={() => setIsScannerOpen(false)}\r\n                            className=\"absolute inset-0 bg-slate-900/60 backdrop-blur-md\"\r\n                        />\r\n                        <motion.div\r\n                            initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n                            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                            exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n                            className=\"relative w-full max-w-md bg-white rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col border border-slate-100\"\r\n                        >\r\n                            <div className=\"p-8 border-b border-slate-100 flex items-center justify-between text-left\">\r\n                                <div>\r\n                                    <h3 className=\"text-2xl font-black text-slate-800 italic uppercase\">Find via QR</h3>\r\n                                    <p className=\"text-slate-500 text-xs font-bold uppercase tracking-wider mt-1\">Scan ID card or Verification Page</p>\r\n                                </div>\r\n                                <button onClick={() => setIsScannerOpen(false)} className=\"p-2 hover:bg-slate-50 rounded-xl transition-colors\">\r\n                                    <X className=\"w-6 h-6 text-slate-400\" />\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"p-8 space-y-6\">\r\n                                <div className=\"aspect-square w-full bg-slate-100 rounded-[2rem] overflow-hidden border-4 border-slate-50 relative\">\r\n                                    <Scanner\r\n                                        onScan={handleScannerResult}\r\n                                        onError={(error) => console.log('Scanner Error:', error)}\r\n                                        styles={{ container: { width: '100%', height: '100%' } }}\r\n                                    />\r\n                                    <div className=\"absolute inset-0 pointer-events-none flex flex-col items-center justify-center\">\r\n                                        <div className=\"w-64 h-64 border-2 border-blue-500/50 rounded-3xl relative\">\r\n                                            <div className=\"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-blue-600 rounded-tl-xl\" />\r\n                                            <div className=\"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-blue-600 rounded-tr-xl\" />\r\n                                            <div className=\"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-blue-600 rounded-bl-xl\" />\r\n                                            <div className=\"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-blue-600 rounded-br-xl\" />\r\n                                            <div className=\"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-500 to-transparent animate-scan\" />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <p className=\"text-[10px] text-center text-slate-400 font-bold uppercase tracking-widest leading-relaxed\">\r\n                                    Position student's QR code within the frame <br />\r\n                                    to automatically find them in the mission roster.\r\n                                </p>\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            <style jsx=\"true\">{`\r\n                @keyframes scan {\r\n                    0%, 100% { top: 0%; }\r\n                    50% { top: 100%; }\r\n                }\r\n                .animate-scan {\r\n                    animation: scan 3s ease-in-out infinite;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OrganizerDashboard;\r\n","usedDeprecatedRules":[]}]
